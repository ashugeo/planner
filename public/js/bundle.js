/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/js/main.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./src/js/calendars.js":
/*!*****************************!*\
  !*** ./src/js/calendars.js ***!
  \*****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _calendars__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./calendars */ \"./src/js/calendars.js\");\n/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./data */ \"./src/js/data.js\");\n/* harmony import */ var _dates__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./dates */ \"./src/js/dates.js\");\n/* harmony import */ var _events__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./events */ \"./src/js/events.js\");\n/* harmony import */ var _selection__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./selection */ \"./src/js/selection.js\");\n/* harmony import */ var _stats__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./stats */ \"./src/js/stats.js\");\n/* harmony import */ var _tooltip__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./tooltip */ \"./src/js/tooltip.js\");\n/* harmony import */ var _ui__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./ui */ \"./src/js/ui.js\");\n\n\n\n\n\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n    data: [],\n    calendarID: -1,\n    selected: 0,\n    start: null,\n    end: null,\n\n    init() {\n        // Update calendars start and end\n        $(document).on('change', '#start, #end', () => {\n            this.updateCalendars();\n            _data__WEBPACK_IMPORTED_MODULE_1__[\"default\"].save();\n        });\n\n        // Switch calendar\n        $(document).on('click', '.calendars-wrap .calendar:not(.selected)', e => {\n            const $calendar = $(e.target).closest('.calendar');\n            _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].selectCalendar($calendar);\n        });\n\n        // Add new calendar\n        $(document).on('click', '.calendars-wrap .add', () => {\n            _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].newCalendar();\n        });\n\n        // Rename calendar in sidebar\n        $(document).on('input', '.calendars-wrap p span', e => {\n            const $calendar = $(e.target).closest('.calendar');\n            const val = $(e.target).text();\n            _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].renameCalendar(val, $calendar);\n        });\n\n        // Rename selected calendar\n        $(document).on('input', '.calendar-wrap h2', e => {\n            const val = $(e.target).text();\n            _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].renameCalendar(val);\n        });\n\n        // Toggle calendar visibility\n        $(document).on('click', '.calendars-wrap [data-tool=\"toggle\"]', e => {\n            const $calendar = $(e.target).closest('.calendar');\n            _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].toggleCalendar($calendar);\n            return false;\n        });\n\n        // Duplicate calendar\n        $(document).on('click', '.calendar .tools [data-tool=\"duplicate\"]', e => {\n            const $calendar = $(e.target).closest('.calendar');\n            _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].duplicateCalendar($calendar);\n            return false;\n        });\n\n        // Delete calendar\n        $(document).on('click', '.calendar .tools [data-tool=\"delete\"]', e => {\n            const $calendar = $(e.target).closest('.calendar');\n            _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].deleteCalendar($calendar);\n            return false;\n        });\n\n        // Toggle edit all\n        $(document).on('click', '.toggle-edit-all', () => {\n            $('nav [data-tool=\"edit-all\"]').toggleClass('checked');\n            $('.calendars-wrap').toggleClass('edit-all');\n        });\n\n        this.buildCalendarHead();\n    },\n\n    // Get start and end dates\n    getStartEnd() {\n        this.start = new Date(new Date($('#start').val()).setHours(0));\n        this.end = new Date(new Date($('#end').val()).setHours(0));\n    },\n\n    buildCalendarHead() {\n        const headFull = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'].map((d, i) =>\n            `<div data-day=\"${i === 6 ? 0 : i + 1}\">\n                ${d}<i class=\"fas fa-chevron-down\"></i>\n                <div class=\"dropdown\">\n                    <span data-tool=\"hide-weekday\"><i class=\"fas fa-eye-slash\"></i>Hide column</span>\n                </div>\n            </div>`\n        ).join('');\n\n        $('.head.full').html(headFull);\n\n        this.getStartEnd();\n        const days = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].range(this.start, this.end);\n\n        const headLinear = days.map(day =>\n            `<div data-day=\"${day.getDay()}\">${day.toLocaleDateString('en-US', { weekday: 'short' })} ${day.getDate()} ${day.toLocaleDateString('en-US', { month: 'short' })}</div>`\n        ).join('');\n\n        $('.head.linear').html(headLinear);\n    },\n    \n    buildCalendar() {\n        if (this.end < this.start) return;\n    \n        // Find first week day\n        const first = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].relativeFirstWeekDay(this.start);\n\n        // Create range from first day to end\n        const days = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].range(first, this.end);\n    \n        // Fill last week\n        while (days.length % 7 !== 0) days.push(new Date(new Date(days[days.length - 1].valueOf()).setDate(days[days.length - 1].getDate() + 1)));\n\n        // Convert days 1D array to weeks 2D array\n        const weeks = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].toWeeksArray(days);\n\n        // Build HTML\n        let html = '';\n        for (const week of weeks) {\n            html += '<div>';\n            for (const day of week) html += this.buildDayHTML(day);\n            html += '</div>';\n        }\n    \n        return html;\n    },\n\n    buildDayHTML(day) {\n        const date = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].toString(day);\n        day.setHours(0);\n\n        // Show day cell as out of bounds if necessary\n        let classname = day < this.start || day > this.end ? ' out' : '';\n        if (day.getDay() === 6 || day.getDay() === 0) classname += ' off';\n\n        const html = `<div class=\"day${classname}\" data-day=\"${day.getDay()}\" data-date=\"${date}\"><span>${day.getDate()} ${day.toLocaleDateString('en-US', { month: 'short' })}</span><div class=\"events\"></div></div>`;\n\n        return html;\n    },\n\n    updateCalendars() {\n        let toAdd = [];\n        let toDelete = [];\n        let toSetIn = [];\n        let toSetOut = [];\n\n        const oldStart = this.start;\n        const oldEnd = this.end;\n        this.getStartEnd();\n        const start = this.start;\n        const end = this.end;\n\n        const oldFirst = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].relativeFirstWeekDay(oldStart);\n        const first = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].relativeFirstWeekDay(start);\n        const oldLast = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].relativeLastWeekDay(oldEnd);\n        const last = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].relativeLastWeekDay(end);\n\n        if (oldStart < start) {\n            toDelete.push(..._dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].range(oldFirst, _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].relativeDate(first, -1)));\n            toSetOut.push(..._dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].range(first, _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].relativeDate(start, -1)));\n        } else if (oldStart > start) {\n            toAdd.push(..._dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].range(first, _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].relativeDate(oldFirst, -1)));\n            toSetIn.push(..._dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].range(start, _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].relativeDate(oldStart, -1)));\n        }\n\n        if (oldEnd < end) {\n            toAdd.push(..._dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].range(_dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].relativeDate(oldLast, 1), last));\n            toSetIn.push(..._dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].range(_dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].relativeDate(oldEnd, 1), end));\n        } else if (oldEnd > end) {\n            toDelete.push(..._dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].range(_dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].relativeDate(last, 1), oldLast));\n            toSetOut.push(..._dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].range(_dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].relativeDate(end, 1), last));\n        }\n\n        // Add new days\n        if (toAdd.length > 1) {\n            const weeks = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].toWeeksArray(toAdd);\n\n            let html = '';\n            for (const week of weeks) {\n                html += '<div>';\n\n                for (const day of week) {\n                    const date = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].toString(day);\n                    html += this.buildDayHTML(day);\n                }\n\n                html += '</div>';\n            }\n\n            if (oldStart > start) $('.calendar.content, .calendar > .content').prepend(html);\n            else if (oldEnd < end) $('.calendar.content, .calendar > .content').append(html);\n\n            this.updateCalendarHeight();\n        }\n\n        // Remove 'out' class for days that are now in scope\n        for (const day of toSetIn) {\n            const date = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].toString(day);\n            $(`.day[data-date=\"${date}\"]`).removeClass('out');\n        }\n\n        // Delete excessive days\n        if (toDelete.length >= 7) {\n            for (const day of toDelete) {\n                const date = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].toString(day);\n                $(`.day[data-date=\"${date}\"]`).remove();\n            }\n        }\n\n        // Set out remaining out-of-scope days\n        for (const day of toSetOut) { \n            const date = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].toString(day);\n            $(`.day[data-date=\"${date}\"]`).addClass('out');\n        }\n    },\n\n    newCalendar(calendar) {\n        const id = calendar ? calendar.id : ++this.calendarID;\n        const title = calendar ? calendar.title : `Calendar ${$('.calendars-wrap .calendar').length + 1}`;\n        const order = calendar ? calendar.order : $('.calendars-wrap .calendar').length;\n\n        // Create HTML\n        const html = `<div class=\"calendar sortable\" data-id=\"${id}\">\n            <div class=\"tools\">\n                <i data-tool=\"toggle\" class=\"far fa-eye\" data-tooltip=\"Hide<span class='shortcut'>⌘H</span>\" data-tooltip-side=\"right\"></i>\n                <i data-tool=\"sort\" data-tooltip=\"Sort\" data-tooltip-side=\"right\">⋮⋮</i>\n                <i data-tool=\"duplicate\" class=\"far fa-clone\" data-tooltip=\"Duplicate<span class='shortcut'>⌘D</span>\" data-tooltip-side=\"right\"></i>\n                <i data-tool=\"delete\" class=\"far fa-trash-alt\" data-tooltip=\"Delete<span class='shortcut'>⌘⌫</span>\" data-tooltip-side=\"right\"></i>\n            </div>\n            <div class=\"content\">${ this.buildCalendar() }</div>\n            <p><span contenteditable spellcheck=\"false\">${title}</span></p>\n        </div>`;\n        \n        let $calendar;\n        if (order) {\n            $('.calendars-wrap .calendar').eq(order - 1).after(html);\n            $calendar = $('.calendars-wrap .calendar').eq(order);\n        } else {\n            $('.calendars-wrap .calendars').append(html);\n            $calendar = $('.calendars-wrap .calendar:last-child');\n        }\n\n        // Select new calendar\n        this.selectCalendar($calendar);\n\n        // Update linear view\n        if (_ui__WEBPACK_IMPORTED_MODULE_7__[\"default\"].viewIs('linear')) _ui__WEBPACK_IMPORTED_MODULE_7__[\"default\"].linearView();\n\n        // Save data\n        this.data.push({\n            id,\n            title,\n            order,\n            events: []\n        });\n\n        // Build events (for calendar duplication)\n        if (calendar && calendar.events) {\n            for (const event of calendar.events) {\n                _events__WEBPACK_IMPORTED_MODULE_3__[\"default\"].buildEvent({\n                    ...event,\n                    calendar: id\n                });\n            }\n        }\n\n        _data__WEBPACK_IMPORTED_MODULE_1__[\"default\"].save();\n    },\n\n    duplicateCalendar($calendar) {\n        const calendar = {\n            id: ++this.calendarID,\n            title: `${$calendar.find('p span').text()} copy`, \n            order: $calendar.index() + 1,\n            events: this.getEventsById(parseInt($calendar.attr('data-id')))\n        };\n\n        this.newCalendar(calendar);\n\n        // Unselect any selection\n        window.getSelection().removeAllRanges();\n\n        if (_ui__WEBPACK_IMPORTED_MODULE_7__[\"default\"].viewIs('linear')) _ui__WEBPACK_IMPORTED_MODULE_7__[\"default\"].linearView();\n\n        _data__WEBPACK_IMPORTED_MODULE_1__[\"default\"].save();\n    },\n\n    selectCalendar($calendar, selectedFirst, selectedLast) {\n        this.selected = parseInt($calendar.attr('data-id'));\n\n        // Store .selected-first and .selected-last dates if not passed\n        if (!selectedFirst) selectedFirst = $('.selected-first').attr('data-date');\n        if (!selectedLast) selectedLast = $('.selected-last').attr('data-date');\n\n        // Update minicals UI\n        $('.calendars-wrap .calendar.selected').removeClass('selected');\n        $calendar.addClass('selected');\n\n        if (_ui__WEBPACK_IMPORTED_MODULE_7__[\"default\"].viewIs('linear')) {\n            // Select calendar\n            $('.calendar-wrap .calendar.selected').removeClass('selected');\n            $(`.calendar-wrap .calendar[data-id=\"${$calendar.attr('data-id')}\"]`).addClass('selected');\n        } else {\n            // Update ID\n            $('.calendar-wrap .content').attr('data-id', $calendar.attr('data-id'));\n        \n            // Update title\n            $('.calendar-wrap h2').html($calendar.find('p span').html());\n        \n            // Update main calendar\n            $('.calendar-wrap .content').html($calendar.find('.content').html()).addClass('selected');\n        }\n\n        // Unselect any selection\n        window.getSelection().removeAllRanges();\n    \n        _selection__WEBPACK_IMPORTED_MODULE_4__[\"default\"].highlightSelection();\n\n        // Restore .selected-first and .selected-last classes\n        $('.selected-first, .selected-last').removeClass('selected-first selected-last');\n        $(`.calendar-wrap .calendar.selected .day[data-date=\"${selectedFirst}\"]`).addClass('selected-first');\n        $(`.calendar-wrap .calendar.selected .day[data-date=\"${selectedLast}\"]`).addClass('selected-last');\n\n        this.updateCalendarHeight();\n        _stats__WEBPACK_IMPORTED_MODULE_5__[\"default\"].update();\n        _data__WEBPACK_IMPORTED_MODULE_1__[\"default\"].save();\n    },\n\n    renameCalendar(val, $calendar = null) {\n        let id;\n        if ($calendar) {\n            // Edited in sidebar, replace in main\n            if ($calendar.hasClass('selected')) {\n                $('.calendar-wrap h2').text(val);\n            }\n            id = parseInt($calendar.attr('data-id'));\n        } else {\n            // Edited in main, replace in sidebar\n            $('.calendars-wrap .calendar.selected p span').text(val);\n            id = parseInt($('.calendars-wrap .calendar.selected').attr('data-id'));\n        }\n\n        // Save data\n        this.data.find(c => c.id === id).title = val;\n        _data__WEBPACK_IMPORTED_MODULE_1__[\"default\"].save();\n    },\n\n    toggleCalendar($calendar) {\n        $calendar.toggleClass('hidden');\n\n        if (_ui__WEBPACK_IMPORTED_MODULE_7__[\"default\"].viewIs('linear')) {\n            $calendar.css('transition', 'none');\n            $(`.calendar-wrap .calendar[data-id=\"${$calendar.attr('data-id')}\"]`).toggleClass('hidden').find('.day').css('transition', 'none');\n            setTimeout(() => {\n                $calendar.css('transition', '');\n                $(`.calendar-wrap .calendar[data-id=\"${$calendar.attr('data-id')}\"] .day`).css('transition', '');\n            }, 500);\n        }\n\n        this.selectAnotherCalendar($calendar);\n    },\n\n    deleteCalendar($calendar) {\n        this.selectAnotherCalendar($calendar);\n        $calendar.remove();\n\n        if (_ui__WEBPACK_IMPORTED_MODULE_7__[\"default\"].viewIs('linear')) _ui__WEBPACK_IMPORTED_MODULE_7__[\"default\"].linearView();\n\n        // Update data\n        const calendar = this.data.find(e => e.id === parseInt($calendar.attr('data-id')));\n        this.data.splice(this.data.indexOf(calendar), 1);\n\n        this.reorder();\n        _data__WEBPACK_IMPORTED_MODULE_1__[\"default\"].save();\n\n        _tooltip__WEBPACK_IMPORTED_MODULE_6__[\"default\"].hide();\n    },\n\n    selectPreviousCalendar() {\n        // Find selected calendar\n        let $calendar = $('.calendars-wrap .calendar.selected');\n\n        // Unselect it\n        $calendar.removeClass('selected');\n\n        // Select previous visible calendar\n        if ($calendar.prevAll('.calendar:not(.hidden)').length) $calendar = $calendar.prevAll('.calendar:not(.hidden)').eq(0)\n\n        // Else, select last visible calendar\n        else $calendar = $('.calendars-wrap .calendar:not(.hidden)').last();\n\n        this.selectCalendar($calendar);\n    },\n\n    selectNextCalendar() {\n        // Find selected calendar\n        let $calendar = $('.calendars-wrap .calendar.selected');\n\n        // Unselect it\n        $calendar.removeClass('selected');\n\n        // Select next visible calendar\n        if ($calendar.nextAll('.calendar:not(.hidden)').length) $calendar = $calendar.nextAll('.calendar:not(.hidden)').eq(0);\n\n        // Else, select first visible calendar\n        else $calendar = $('.calendars-wrap .calendar:not(.hidden)').first();\n\n        this.selectCalendar($calendar);\n    },\n\n    selectFirstCalendar() {\n        const $calendar = $('.calendars-wrap .calendar').eq(0);\n        this.selectCalendar($calendar);\n    },\n\n    selectAnotherCalendar($calendar) {\n        // Select next (or previous) visible calendar\n        if ($calendar.hasClass('selected')) {\n            const $calendarToSelect = $calendar.nextAll(':not(.hidden)').eq(0).length ? $calendar.nextAll(':not(.hidden)').eq(0) : $calendar.prevAll(':not(.hidden)').length ? $calendar.prevAll(':not(.hidden)').eq(0) : null;\n            if ($calendarToSelect) this.selectCalendar($calendarToSelect);\n        }\n    },\n\n    updateCalendarHeight() {\n        const mostEventsPerDay = Math.max(...$('.calendar-wrap .day .events').map((_, el) => $(el).find('.event').length));\n        const height = `${Math.max(40 + mostEventsPerDay * 32, 72)}px`;\n        $('.calendar-wrap .day').css('height', height);\n\n        if (_ui__WEBPACK_IMPORTED_MODULE_7__[\"default\"].viewIs('linear')) $('.calendars-wrap .calendar').css('height', height);\n        else $('.calendars-wrap .calendar').css('height', '');\n    },\n\n    getEventsById(id) {\n        return this.data.find(c => c.id === id).events;\n    },\n\n    reorder() {\n        // Update linear view\n        if (_ui__WEBPACK_IMPORTED_MODULE_7__[\"default\"].viewIs('linear')) _ui__WEBPACK_IMPORTED_MODULE_7__[\"default\"].linearView();\n\n        this.data.forEach(c => c.order = parseInt($(`.calendars-wrap .calendar[data-id=\"${c.id}\"]`).attr('data-order')));\n    }\n});\n\n//# sourceURL=webpack:///./src/js/calendars.js?");

/***/ }),

/***/ "./src/js/data.js":
/*!************************!*\
  !*** ./src/js/data.js ***!
  \************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _calendars__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./calendars */ \"./src/js/calendars.js\");\n/* harmony import */ var _events__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./events */ \"./src/js/events.js\");\n/* harmony import */ var _ui__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ui */ \"./src/js/ui.js\");\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n    loading: false,\n    loaded: false,\n\n    init() {\n        this.load();\n    },\n    \n    load() {\n        this.loading = true;\n        let data = localStorage.getItem('data');\n        \n        if (!data) {\n            this.loading = false;\n            return;\n        }\n\n        data = JSON.parse(data);\n\n        _ui__WEBPACK_IMPORTED_MODULE_2__[\"default\"].changeTool(data.selectedTool);\n        if (data.view === 'linear') _ui__WEBPACK_IMPORTED_MODULE_2__[\"default\"].linearView();\n\n        if (data.start) $('#start').val(data.start);\n        if (data.end) $('#end').val(data.end);\n\n        _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getStartEnd();\n        _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].buildCalendarHead();\n\n        // Add events\n        for (const event of data.events.sort((a, b) => a.order < b.order ? -1 : 1)) _events__WEBPACK_IMPORTED_MODULE_1__[\"default\"].newEvent(event);\n        \n        // Add calendars\n        for (const calendar of data.calendars.sort((a, b) => a.order < b.order ? -1 : 1)) _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].newCalendar(calendar);\n\n        _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].selectCalendar($(`.calendars-wrap .calendar[data-id=\"${data.selectedCalendar}\"]`));\n\n        // Save current ids\n        _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].calendarID = Math.max(...data.calendars.map(c => c.id), -1);\n        _events__WEBPACK_IMPORTED_MODULE_1__[\"default\"].eventID = Math.max(...data.calendars.map(c => c.events.map(e => e.id)).flat(), -1);\n\n        // Hide days if necessary\n        if (data.daysShown) for (const [day, show] of data.daysShown.entries()) {\n            if (!show) _ui__WEBPACK_IMPORTED_MODULE_2__[\"default\"].showHideWeekday(day, show);\n        }\n\n        this.loading = false;\n        this.loaded = true;\n    },\n\n    save(manual = false) {\n        // Prevent saving while loading\n        if (this.loading) return false;\n\n        const data = this.getData();\n        localStorage.setItem('data', JSON.stringify(data));\n\n        if (manual) {\n            // TODO: display message to explain auto-save\n\n            // Prevent default browser save window (Cmd + S)\n            return false;\n        }\n    },\n\n    getData() {\n        const data = {\n            start: $('#start').val(),\n            end: $('#end').val(),\n            events: [..._events__WEBPACK_IMPORTED_MODULE_1__[\"default\"].data],\n            calendars: [..._calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].data],\n            selectedCalendar: _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].selected,\n            selectedTool: _ui__WEBPACK_IMPORTED_MODULE_2__[\"default\"].tool,\n            view: _ui__WEBPACK_IMPORTED_MODULE_2__[\"default\"].view,\n            daysShown: _ui__WEBPACK_IMPORTED_MODULE_2__[\"default\"].daysShown\n        };\n\n        return data;\n    },\n\n    clear() {\n        // For development purposes only\n        localStorage.removeItem('data');\n    },\n\n    download() {\n        const data = this.getData();\n        const a = document.createElement('a');\n        a.href = `data:text/json;charset=utf-8,${encodeURIComponent(JSON.stringify(data))}`;\n        a.download = 'project.planner';\n        a.click();\n    }\n});\n\n//# sourceURL=webpack:///./src/js/data.js?");

/***/ }),

/***/ "./src/js/dates.js":
/*!*************************!*\
  !*** ./src/js/dates.js ***!
  \*************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n    init() {\n        Date.prototype.getWeek = function (dowOffset = 1) {\n            const newYear = new Date(this.getFullYear(), 0, 1);\n            let day = newYear.getDay() - dowOffset;\n            day = (day >= 0 ? day : day + 7);\n            const daynum = Math.floor((this.getTime() - newYear.getTime() - \n            (this.getTimezoneOffset() - newYear.getTimezoneOffset()) * 60000) / 86400000) + 1;\n            \n            let weeknum;\n            if (day < 4) {\n                weeknum = Math.floor((daynum + day - 1) / 7) + 1;\n                if (weeknum > 52) {\n                    nYear = new Date(this.getFullYear() + 1, 0, 1);\n                    nday = nYear.getDay() - dowOffset;\n                    nday = nday >= 0 ? nday : nday + 7;\n                    weeknum = nday < 4 ? 1 : 53;\n                }\n            } else {\n                weeknum = Math.floor((daynum + day - 1) / 7);\n            }\n            return weeknum;\n        };\n    },\n\n    toString(date) {\n        return `${date.getFullYear()}-${`${date.getMonth() + 1}`.padStart(2, '0')}-${`${date.getDate()}`.padStart(2, '0')}`;\n    },\n\n    isInArray(arr, date) {\n        return arr.some(d => d.getTime() === date.getTime());\n    },\n\n    relativeDate(date, n) {\n        return new Date(new Date(date).setDate(date.getDate() + n));\n    },\n\n    relativeFirstWeekDay(date) {\n        return new Date(new Date(date).setDate(date.getDate() - date.getDay() + (date.getDay() === 0 ? -6 : 1)));\n    },\n\n    relativeLastWeekDay(date) {\n        return new Date(new Date(date).setDate(date.getDay() === 0 ? date.getDate() : (date.getDate() + 7 - date.getDay())))\n    },\n\n    // Build array of all days from start to end\n    range(start, end) {\n        const days = [new Date(start)];\n        while (days[days.length - 1] < new Date(end)) days.push(new Date(new Date(days[days.length - 1].valueOf()).setDate(days[days.length - 1].getDate() + 1)));\n        return days;\n    },\n\n    findLowestWeekDay(arr) {\n        return Math.min(...arr.map(d => d.getDay()).map(w => w === 0 ? 7 : w));\n    },\n\n    findHighestWeekDay(arr) {\n        return Math.max(...arr.map(d => d.getDay()).map(w => w === 0 ? 7 : w));\n    },\n\n    toWeeksArray(days) {\n        const weeks = days.reduce((acc, curr) => {\n            if (!acc.length) {\n                acc = [[curr]];\n            } else {\n                const lastWeek = acc[acc.length - 1];\n\n                if (curr.getWeek() === lastWeek[lastWeek.length - 1].getWeek()) lastWeek.push(curr);\n                else acc.push([curr]);\n            }\n\n            return acc;\n        }, []);\n        \n        return weeks;\n    },\n\n    delta(date1, date2) {\n        return Math.ceil((new Date(date2) - new Date(date1)) / (1000 * 60 * 60 * 24)); \n    }\n});\n\n//# sourceURL=webpack:///./src/js/dates.js?");

/***/ }),

/***/ "./src/js/events.js":
/*!**************************!*\
  !*** ./src/js/events.js ***!
  \**************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _calendars__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./calendars */ \"./src/js/calendars.js\");\n/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./data */ \"./src/js/data.js\");\n/* harmony import */ var _dates__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./dates */ \"./src/js/dates.js\");\n/* harmony import */ var _history__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./history */ \"./src/js/history.js\");\n/* harmony import */ var _selection__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./selection */ \"./src/js/selection.js\");\n/* harmony import */ var _settings__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./settings */ \"./src/js/settings.js\");\n/* harmony import */ var _stats__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./stats */ \"./src/js/stats.js\");\n\n\n\n\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n    data: [],\n    eventID: -1,\n    type: -1,\n\n    init() {\n        // Add new event\n        $(document).on('click', '.events-wrap .add', () => {\n            this.newEvent();\n            return false;\n        });\n\n        // Rename event\n        $(document).on('input', '.events-wrap ul span', e => {\n            const $el = $(e.target);\n            this.renameEvent($el);\n        });\n\n        // Insert event instances\n        $(document).on('click', '.events-wrap ul li', e => {\n            const $el = $(e.target);\n            if ($el.is('.tools') || $el.parents().is('.tools')) return;\n\n            const $event = $el.closest('li');\n            this.insertEvent($event);\n        });\n\n        // Open dropdown menu\n        $(document).on('click', '.events-wrap ul li [data-tool=\"dropdown\"]', e => {\n            // Close any open dropdown menu\n            $('.dropdown.visible').removeClass('visible');\n            $('#color-swatch').removeClass('visible');\n\n            const $dropdown = $(e.target).closest('li').find('.dropdown');\n            $dropdown.toggleClass('visible');\n            e.stopPropagation();\n        });\n\n        // Click outside\n        $(document).on('click', e => {\n            if ($(e.target).is('#color-swatch')) return;\n\n            // Close dropdown menu\n            $('.dropdown.visible').removeClass('visible');\n            $('[data-day].open').removeClass('open');\n            $('#color-swatch').removeClass('visible');\n\n            if ($(e.target).parents().is('[data-tool=\"dropdown\"], .dropdown')) return;\n\n            // Remove contenteditable attr\n            $('.events-wrap ul li .title[contenteditable]').removeAttr('contenteditable');\n        });\n\n        // Rename event\n        $(document).on('click', '.events-wrap ul li [data-tool=\"rename\"]', e => {\n            const $title = $(e.target).closest('li').find('span.title');\n            $title.attr('contenteditable', 'true').focus();\n\n            const setEndOfContenteditable = (contentEditableElement) => {\n                let range = document.createRange();\n                range.selectNodeContents(contentEditableElement);\n                range.collapse(false);\n                let selection = window.getSelection();\n                selection.removeAllRanges();\n                selection.addRange(range);\n            }\n\n            setEndOfContenteditable($title[0]);\n\n            // Close dropdown menu\n            $('.dropdown.visible').removeClass('visible');\n\n            // Prevent li click\n            return false;\n        });\n\n        // Open color swatch\n        $(document).on('click', '.events-wrap ul li [data-tool=\"color\"]', e => {\n            const $el = $(e.target.closest('li'));\n\n            // Select current event color\n            $('#color-swatch .color.selected').removeClass('selected');\n            $($('#color-swatch .color').toArray().find(c => $(c).attr('data-color') === $el.attr('data-color'))).addClass('selected');\n\n            // Open swatch\n            $('#color-swatch')\n            .css({\n                'top': $el.position().top + $el.outerHeight(),\n                'left': $el.position().left\n            })\n            .addClass('visible')\n            .attr('data-type', $el.attr('data-type'));\n\n            // Close dropdown\n            $('.dropdown.visible').removeClass('visible');\n\n            return false;\n        });\n\n        // Change event color\n        $(document).on('click', '#color-swatch .color', e => {\n            const $color = $(e.target);\n            const eventType = parseInt($('#color-swatch').attr('data-type'));\n\n            // Select color\n            $('#color-swatch .color.selected').removeClass('selected');\n            $color.addClass('selected');\n\n            // Update event, occurences and stats\n            const color = $color.attr('data-color');\n            $(`.events-wrap ul li[data-type=\"${eventType}\"], .event[data-type=\"${eventType}\"]`).attr('data-color', color);\n            $(`.stat[data-type=\"${eventType}\"] .event-icon`).attr('data-color', color);\n\n            // Update data\n            this.data.find(e => e.type === eventType).color = parseInt($color.attr('data-color'));\n            _data__WEBPACK_IMPORTED_MODULE_1__[\"default\"].save();\n\n            return false;\n        });\n\n        // Delete event\n        $(document).on('click', '.events-wrap ul li [data-tool=\"delete\"]', e => {\n            const $el = $(e.target).closest('li');\n            const type = parseInt($el.attr('data-type'));\n            $el.remove();\n            this.removeEventsByType(type);\n            _stats__WEBPACK_IMPORTED_MODULE_6__[\"default\"].update();\n\n            // Update data\n            const event = this.data.find(e => e.type === type);\n            this.data.splice(this.data.indexOf(event), 1);\n            _data__WEBPACK_IMPORTED_MODULE_1__[\"default\"].save();\n        });\n\n        // Selected event\n        // $(document).on('mousedown', '.events-wrap ul li', e => {\n        //     const $el = $(e.currentTarget);\n        //     $el.siblings('.selected').removeClass('selected');\n        //     $el.toggleClass('selected');\n        // });\n\n        for (let i = 0; i <= 19; i += 1) {\n            $('#color-swatch').append(`<div class=\"color\" data-color=\"${i}\"></div>`);\n        }\n    },\n\n    newEvent(events) {\n        if (!Array.isArray(events)) events = [events];\n\n        for (const event of events) {\n            this.type++;\n            const type = event && event.type ? event.type : this.type;\n            const color = event && !isNaN(event.color) ? event.color : type;\n\n            const li = `<li data-type=\"${type}\" class=\"sortable\" data-color=\"${color}\">\n                <span class=\"title\" ${!event ? 'contenteditable' : ''} spellcheck=\"false\">${event && event.title ? event.title : ''}</span>\n                <span class=\"tools\">\n                    <i class=\"fas fa-angle-down\" data-tool=\"dropdown\"></i>\n                    <i data-tool=\"sort\">⋮⋮</i>\n                    <span class=\"dropdown\">\n                        <span data-tool=\"rename\"><i class=\"fas fa-pen\"></i>Rename</span>\n                        <span data-tool=\"color\"><i class=\"fas fa-palette\"></i>Change color</span>\n                        <span class=\"border-top\" data-tool=\"delete\"><i class=\"far fa-trash-alt\"></i>Delete</span>\n                    </span>\n                </span>\n            </li>`;\n\n            const $ul = $('.events-wrap ul');\n            $ul.append(li);\n\n            // Select new event\n            // $ul.find('li.selected').removeClass('selected');\n            // $ul.find('li:last-child').addClass('selected');\n\n            // Focus span if empty\n            if (!event) $ul.find('li:last-child .title').focus();\n\n            // Save data\n            this.data.push({\n                ...event,\n                type,\n                color\n            });\n        }\n\n        _stats__WEBPACK_IMPORTED_MODULE_6__[\"default\"].update();\n    },\n\n    renameEvent($el) {\n        const val = $el.text();\n        const type = parseInt($el.closest('li').attr('data-type'));\n\n        $(`.event[data-type=\"${type}\"] span`).text(val);\n\n        // Update data\n        this.data.find(e => e.type === type).title = val;\n\n        _stats__WEBPACK_IMPORTED_MODULE_6__[\"default\"].update();\n        _data__WEBPACK_IMPORTED_MODULE_1__[\"default\"].save();\n    },\n\n    insertEvent($event) {\n        const type = parseInt($event.attr('data-type'));\n    \n        const selectedDaysEvents = _selection__WEBPACK_IMPORTED_MODULE_4__[\"default\"].selectedDays.map(d => {\n            const date = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].toString(d);\n            return $(`.calendar-wrap .day[data-date=\"${date}\"] .event`).attr('data-type');\n        });\n    \n        if (_settings__WEBPACK_IMPORTED_MODULE_5__[\"default\"].oneEventPerDay && selectedDaysEvents.every(e => e === type)) {\n            // If only one event per day and same type, remove event and don't recreate one\n            for (const day of _selection__WEBPACK_IMPORTED_MODULE_4__[\"default\"].selectedDays) {\n                const date = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].toString(day);\n\n                // Edit all calendars or only selected one\n                let $events;\n                if ($('.calendars-wrap').hasClass('edit-all')) {\n                    $events = $(`.day[data-date=\"${date}\"] .event`);\n                } else {\n                    $events = $(`.calendars-wrap .calendar.selected .day[data-date=\"${date}\"] .event, .calendar-wrap .day[data-date=\"${date}\"] .event`);\n                }\n\n                $events.remove();\n            }\n        } else {\n            const action = {\n                type: 'addEvents',\n                events: []\n            };\n    \n            for (const day of _selection__WEBPACK_IMPORTED_MODULE_4__[\"default\"].selectedDays) {\n                const date = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].toString(day);\n\n                // Edit all calendars or only selected one\n                let $events;\n                if ($('.calendars-wrap').hasClass('edit-all')) {\n                    $events = $(`.day[data-date=\"${date}\"] .event`);\n                } else {\n                    $events = $(`.calendars-wrap .calendar.selected .day[data-date=\"${date}\"] .event, .calendar-wrap .day[data-date=\"${date}\"] .event`);\n                }\n\n                // Remove existing event if one event per day only\n                if (_settings__WEBPACK_IMPORTED_MODULE_5__[\"default\"].oneEventPerDay) $events.remove();\n                    \n                const $day = $(`.calendar-wrap .day[data-date=\"${date}\"]`);\n                \n                const event = {\n                    id: ++this.eventID,\n                    calendar: parseInt($('.calendars-wrap .calendar.selected').attr('data-id')),\n                    type: type,\n                    // title: $event.find('.title').text(),\n                    // color: $event.css('background-color'),\n                    start: $day.attr('data-date'),\n                    end: $day.attr('data-date')\n                };\n    \n                action.events.push(event);\n        \n                this.buildEvent(event);\n            }\n    \n            _history__WEBPACK_IMPORTED_MODULE_3__[\"default\"].pushAction(action);\n        }\n\n        _stats__WEBPACK_IMPORTED_MODULE_6__[\"default\"].update();\n        _data__WEBPACK_IMPORTED_MODULE_1__[\"default\"].save();\n    },\n\n    getEventsWrap(event, day) {\n        const date = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].toString(new Date(day));\n        let $el;\n        if ($('.calendars-wrap').hasClass('edit-all')) {\n            $el = $(`.day[data-date=\"${date}\"] .events`);\n        } else {\n            $el = $(`.calendar[data-id=\"${event.calendar}\"]`).length ? $(`.calendar[data-id=\"${event.calendar}\"] .day[data-date=\"${date}\"] .events`) : $(`.calendar.selected .day[data-date=\"${date}\"] .events, .calendar-wrap .day[data-date=\"${date}\"] .events`);\n        }\n        return $el;\n    },\n\n    getEventTopCoordinate(event) {\n        const range = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].range(event.start, event.end);\n\n        // Get first available top coordinate for multi-days event\n        const top = new Array(32).fill(0).map(d => d).findIndex((_, i) => {\n            return range.map(day => {\n                const events = this.getEventsWrap(event, day).eq(0).find(`.event[data-id!=\"${event.id}\"]`).toArray();\n                return events.every(ev => parseInt($(ev).css('top')) !== i * 32);\n            }).every(d => d);\n        });\n\n        return top;\n    },\n\n    buildEvent(event) {\n        const range = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].range(event.start, event.end);\n\n        const top = this.getEventTopCoordinate(event);\n\n        for (const day of range) {\n            const $events = this.getEventsWrap(event, day);\n    \n            // Build classname\n            let classname = '';\n            if (day.valueOf() === new Date(event.start).valueOf()) classname += ' start';\n            if (day.valueOf() === new Date(event.end).valueOf()) classname += ' end';\n\n            let eventType;\n            if (event.type === undefined) {\n                eventType = { title: '', color: 17 };\n                classname += ' new';\n            } else {\n                eventType = this.data.find(e => e.type === event.type);\n            }\n            \n            // Find title and color from event\n            const { title, color } = eventType;\n\n            const html = `<div data-id=\"${event.id}\" data-type=\"${event.type}\" data-color=\"${color}\" class=\"event${classname}\" style=\"top: ${top * 32}px\">\n                ${classname.includes('start') || day.getDay() === 1 ? `<span class=\"title${!classname.includes('start') ? ' not-linear' : ''}\">${title}</span>` : ''}\n                ${classname.includes('start') ? '<div class=\"anchor anchor-start\"></div>' : ''}\n                ${classname.includes('end') ? '<div class=\"anchor anchor-end\"></div>' : ''}\n            </div>`;\n\n            // Add event\n            $events.append(html);\n        }\n\n        // Save data\n        const { id, type, start, end } = event;\n        _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].data.find(c => c.id === event.calendar).events.push({\n            id,\n            type,\n            start,\n            end\n        });\n\n        _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].updateCalendarHeight();\n    },\n\n    updateEvent(event) {\n        this.removeEvent(event);\n        this.buildEvent(event);\n    },\n\n    replaceEvent(event, undo = false) {\n        // Edit all calendars or only selected one\n        let $el;\n        if ($('.calendars-wrap').hasClass('edit-all')) {\n            $el = $(`.event[data-id=\"${event.id}\"]`);\n        } else {\n            $el = $(`.calendar[data-id=\"${event.calendar}\"]`).length ? $(`.calendar[data-id=\"${event.calendar}\"] .event[data-id=\"${event.id}\"]`) : $(`.calendar.selected .event[data-id=\"${event.id}\"], .calendar-wrap .event[data-id=\"${event.id}\"]`);\n        }\n\n        let $target;\n        if (!undo) $target = $(`.events-wrap ul li[data-type=\"${event.type}\"]`);\n        else $target = $(`.events-wrap ul li[data-type=\"${event.from}\"]`);\n\n        $el.find('.title').text($target.find('.title').text());\n        $el.attr('data-type', $target.attr('data-type'));\n        $el.attr('data-color', $target.attr('data-color'));\n\n        // Update data\n        _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].data.find(c => c.id === event.calendar).events.find(e => e.id === event.id).type = event.type;\n\n        _stats__WEBPACK_IMPORTED_MODULE_6__[\"default\"].update();\n    },\n\n    removeEvent(event) {\n        $(`.event[data-id=\"${event.id}\"]`).remove();\n\n        // Find all events to update top coordinate for\n        const range = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].range(event.start, event.end);\n        const eventIDs = new Set();\n\n        for (const day of range) {\n            const $events = this.getEventsWrap(event, day);\n            $events.find('.event').each((_, el) => {\n                const $el = $(el);\n                const id = parseInt($el.attr('data-id'));\n                eventIDs.add(id);\n            });\n        }\n\n        for (const id of eventIDs) {\n            const event = { id,\n                start: $(`.event[data-id=\"${id}\"].start`).eq(0).closest('.day').attr('data-date'),\n                end: $(`.event[data-id=\"${id}\"].end`).eq(0).closest('.day').attr('data-date'), \n                calendar: parseInt($(`.event[data-id=\"${id}\"].start`).eq(0).closest('.calendar').attr('data-id'))\n            };\n\n            // Update top coordinate\n            const top = this.getEventTopCoordinate(event);\n            $(`.event[data-id=\"${id}\"]`).css('top', top * 32);\n        }\n\n        _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].updateCalendarHeight();\n\n        // Update data\n        _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].data.forEach(c => c.events = c.events.filter(e => e.id !== event.id));\n    },\n\n    removeEventsByType(type) {\n        // Create action for history\n        const action = {\n            type: 'removeEvents',\n            events: []\n        };\n\n        for (const minical of $('.calendars-wrap .calendar').toArray()) {\n            const $events = $(minical).find(`.event[data-type=\"${type}\"]`);\n\n            $events.each((_, el) => {\n                const $el = $(el);\n\n                const event = {\n                    id: parseInt($el.attr('data-id')),\n                    calendar: parseInt($(minical).attr('data-id')),\n                    type: $el.attr('data-type'),\n                    // title: $el.find('.title').text(),\n                    // color: $el.css('background-color'),\n                    start: $el.closest('.day').attr('data-date'),\n                    end: $el.closest('.day').attr('data-date')\n                };\n\n                // Remove event\n                this.removeEvent(event);\n\n                // Save event in action\n                action.events.push(event);\n            });\n        }\n\n        // Save action in history\n        _history__WEBPACK_IMPORTED_MODULE_3__[\"default\"].pushAction(action);\n    },\n\n    reorder() {\n        this.data.forEach(e => e.order = parseInt($(`.events-wrap ul li[data-type=\"${e.type}\"]`).attr('data-order')));\n    }\n});\n\n//# sourceURL=webpack:///./src/js/events.js?");

/***/ }),

/***/ "./src/js/history.js":
/*!***************************!*\
  !*** ./src/js/history.js ***!
  \***************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./data */ \"./src/js/data.js\");\n/* harmony import */ var _events__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./events */ \"./src/js/events.js\");\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n    actions: [],\n    actionsIndex: 0,\n\n    pushAction(action) {\n        this.actions.length = this.actionsIndex;\n        this.actions.push(action);\n        this.actionsIndex += 1;\n\n        this.updateNav('undo', -1);\n        this.updateNav('redo');\n    },\n\n    undo() {\n        if (this.actionsIndex - 1 < 0) return;\n        this.actionsIndex -= 1;\n        const action = this.actions[this.actionsIndex];\n\n        if (action.type === 'addEvents') for (const event of action.events) _events__WEBPACK_IMPORTED_MODULE_1__[\"default\"].removeEvent(event);\n        else if (action.type === 'removeEvents') for (const event of action.events) _events__WEBPACK_IMPORTED_MODULE_1__[\"default\"].buildEvent(event);\n        else if (action.type === 'replaceEvents') for (const event of action.events) _events__WEBPACK_IMPORTED_MODULE_1__[\"default\"].replaceEvent(event, true);\n\n        if (this.actionsIndex === 0) this.updateNav('undo');\n        else this.updateNav('undo', -1);\n\n        this.updateNav('redo', 0);\n\n        _data__WEBPACK_IMPORTED_MODULE_0__[\"default\"].save();\n    },\n\n    redo() {\n        if (this.actionsIndex + 1 > this.actions.length) return;\n        const action = this.actions[this.actionsIndex];\n        if (action.type === 'addEvents') for (const event of action.events) _events__WEBPACK_IMPORTED_MODULE_1__[\"default\"].buildEvent(event);\n        else if (action.type === 'removeEvents') for (const event of action.events) _events__WEBPACK_IMPORTED_MODULE_1__[\"default\"].removeEvent(event)\n        else if (action.type === 'replaceEvents') for (const event of action.events) _events__WEBPACK_IMPORTED_MODULE_1__[\"default\"].replaceEvent(event);\n        ;\n        \n        this.actionsIndex += 1;\n\n        if (this.actions[this.actionsIndex]) this.updateNav('redo', 0);\n        else this.updateNav('redo');\n\n        this.updateNav('undo', -1);\n\n        _data__WEBPACK_IMPORTED_MODULE_0__[\"default\"].save();\n    },\n\n    updateNav(type, actionIndex) {\n        if (isNaN(actionIndex)) {\n            // Disable nav undo/redo options\n            $(`nav [data-tool=\"${type}\"]`).text(type === 'undo' ? 'Undo' : 'Redo').addClass('disabled');\n        } else {\n            // Update nav undo/redo options text\n            const buildActionText = (action) => {\n                const n = action.type === 'addEvents' ? action.events.length : action.events.length / 2;\n                const s = n > 1 ? 's' : '';\n        \n                const text = {\n                    'addEvents': `add ${n} event${s}`,\n                    'removeEvents': `remove ${n} event${s}`,\n                    'replaceEvents': `replace ${n} event${s}`\n                }[action.type];\n        \n                return text;\n            };\n\n            const action = this.actions[this.actionsIndex + actionIndex];\n            $(`nav [data-tool=\"${type}\"]`).text(`${type === 'undo' ? 'Undo' : 'Redo'} ${buildActionText(action)}`).removeClass('disabled');\n        }\n    }\n});\n\n//# sourceURL=webpack:///./src/js/history.js?");

/***/ }),

/***/ "./src/js/inputs.js":
/*!**************************!*\
  !*** ./src/js/inputs.js ***!
  \**************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _calendars__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./calendars */ \"./src/js/calendars.js\");\n/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./data */ \"./src/js/data.js\");\n/* harmony import */ var _events__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./events */ \"./src/js/events.js\");\n/* harmony import */ var _history__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./history */ \"./src/js/history.js\");\n/* harmony import */ var _panel__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./panel */ \"./src/js/panel.js\");\n/* harmony import */ var _selection__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./selection */ \"./src/js/selection.js\");\n/* harmony import */ var _ui__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./ui */ \"./src/js/ui.js\");\n\n\n\n\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n    capsLockIsDown: false,\n    isMouseDown: false,\n\n    init() {\n        // Store mouseclick status\n        $(document).on('mousedown', () => { this.isMouseDown = true; });\n        $(document).on('mouseup', () => { this.isMouseDown = false; });\n\n        // Shortcuts\n        $(document).on('keydown', e => {\n            // Capture caps lock\n            if (e.which === 20) this.capsLock(e.originalEvent.getModifierState('CapsLock'));\n\n            if (e.which === 27 && $('.event.new').length) _selection__WEBPACK_IMPORTED_MODULE_5__[\"default\"].cancelDraw(); // Escape new event\n\n            // Disable custom shortcuts when editing a contenteditable\n            if ($(e.target).is('[contenteditable]')) return;\n\n            const ctrlOrMeta = e.metaKey || e.ctrlKey;\n\n            if ([37, 38, 39, 40].includes(e.which)) {                             // Arrow keys\n                // Prevent scroll\n                e.preventDefault();\n\n                if (_panel__WEBPACK_IMPORTED_MODULE_4__[\"default\"].isOpen) return;\n\n                if (ctrlOrMeta && [38, 40].includes(e.which)) {\n                    if (e.which === 38) _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].selectPreviousCalendar();       // Cmd + up\n                    if (e.which === 40) _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].selectNextCalendar();           // Cmd + down\n                } else {\n                    _selection__WEBPACK_IMPORTED_MODULE_5__[\"default\"].moveSelection(e);                                   // Cmd + right/left\n                }\n            }\n            else if (e.which === 18 && this.isMouseDown) _selection__WEBPACK_IMPORTED_MODULE_5__[\"default\"].dragSelect(e); // Alt + click\n            else if (ctrlOrMeta && e.which === 8) {                               // Cmd + backspace\n                const $calendar = $('.calendars-wrap .calendar.selected');\n                _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].deleteCalendar($calendar);\n            }\n            else if (e.which === 8) _selection__WEBPACK_IMPORTED_MODULE_5__[\"default\"].emptySelection();                   // Backspace\n            else if (e.which === 27) {                                            // Esc\n                if (_panel__WEBPACK_IMPORTED_MODULE_4__[\"default\"].isOpen) _panel__WEBPACK_IMPORTED_MODULE_4__[\"default\"].closePanel();\n                else _selection__WEBPACK_IMPORTED_MODULE_5__[\"default\"].narrowSelection();\n            }\n            else if (ctrlOrMeta && e.which === 65) _selection__WEBPACK_IMPORTED_MODULE_5__[\"default\"].selectAll();         // Cmd + A\n            else if (ctrlOrMeta && e.which === 67) _selection__WEBPACK_IMPORTED_MODULE_5__[\"default\"].copySelection();     // Cmd + C\n            else if (ctrlOrMeta && e.which === 68) {                              // Cmd + D\n                const $calendar = $('.calendars-wrap .calendar.selected');\n                _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].duplicateCalendar($calendar);\n                return false;\n            }\n            else if (ctrlOrMeta && e.which === 72) {                              // Cmd + H\n                const $calendar = $('.calendars-wrap .calendar.selected');\n                _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].toggleCalendar($calendar);\n                return false;\n            }\n            else if (ctrlOrMeta && e.which === 75) _data__WEBPACK_IMPORTED_MODULE_1__[\"default\"].clear();                  // Cmd + K\n            else if (ctrlOrMeta && e.which === 83) return _data__WEBPACK_IMPORTED_MODULE_1__[\"default\"].save(true);        // Cmd + S\n            else if (ctrlOrMeta && e.which === 86) _selection__WEBPACK_IMPORTED_MODULE_5__[\"default\"].pasteSelection();    // Cmd + V\n            else if (ctrlOrMeta && e.which === 88) _selection__WEBPACK_IMPORTED_MODULE_5__[\"default\"].cutSelection();      // Cmd + X\n            else if (ctrlOrMeta && e.which === 90) {                              // Cmd + Z\n                e.preventDefault();\n                if (e.shiftKey) _history__WEBPACK_IMPORTED_MODULE_3__[\"default\"].redo();\n                else _history__WEBPACK_IMPORTED_MODULE_3__[\"default\"].undo();\n            }\n            // else if (e.which === 67) ui.changeTool('comment');                    // C\n            else if (e.which === 68) _ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].changeTool('draw');                       // D\n            else if (e.which === 70) _ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].fullView();                               // F\n            else if (e.which === 76) _ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].linearView();                             // L\n            else if (e.which === 83) _ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].changeTool('select');                     // S\n        });\n\n        // Enter key in contenteditable: blur\n        $(document).on('keypress', '[contenteditable]', e => {\n            if (e.which === 13) {\n                const $el = $(e.target);\n                $el.blur();\n\n                // If leaving an event title, remove contenteditable\n                if ($el.is('.title')) $el.removeAttr('contenteditable');\n\n                // Remove selection if any\n                window.getSelection().removeAllRanges();\n\n                // Prevent panel opening\n                return false;\n            }\n        });\n\n        $(document).on('keyup', e => {\n            if (e.which === 18 && this.isMouseDown) _selection__WEBPACK_IMPORTED_MODULE_5__[\"default\"].dragSelect(e);\n\n            // Capture caps lock (unlock)\n            else if (e.which === 20) this.capsLock(e.originalEvent.getModifierState('CapsLock'));\n        });\n\n        // // Click on contenteditable: select all\n        // $(document).on('click', '[contenteditable]', e => {\n        //     document.execCommand('selectAll', false, null);\n        // });\n\n        // // Tab to contenteditable: select all\n        // $(document).on('keyup', '[contenteditable]', e => {\n        //     if (e.which === 9) document.execCommand('selectAll', false, null);\n        // });\n    },\n\n    capsLock(isDown) {\n        // Save status\n        this.capsLockIsDown = isDown;\n\n        if (isDown) {\n            $('.calendars-wrap').addClass('edit-all');\n            $('nav [data-tool=\"edit-all\"]').addClass('checked');\n        } else {\n            $('.calendars-wrap').removeClass('edit-all');\n            $('nav [data-tool=\"edit-all\"]').removeClass('checked');\n        }\n    }\n});\n\n//# sourceURL=webpack:///./src/js/inputs.js?");

/***/ }),

/***/ "./src/js/main.js":
/*!************************!*\
  !*** ./src/js/main.js ***!
  \************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _calendars__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./calendars */ \"./src/js/calendars.js\");\n/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./data */ \"./src/js/data.js\");\n/* harmony import */ var _dates__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./dates */ \"./src/js/dates.js\");\n/* harmony import */ var _events__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./events */ \"./src/js/events.js\");\n/* harmony import */ var _inputs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./inputs */ \"./src/js/inputs.js\");\n/* harmony import */ var _panel__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./panel */ \"./src/js/panel.js\");\n/* harmony import */ var _selection__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./selection */ \"./src/js/selection.js\");\n/* harmony import */ var _sortable__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./sortable */ \"./src/js/sortable.js\");\n/* harmony import */ var _stats__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./stats */ \"./src/js/stats.js\");\n/* harmony import */ var _templates__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./templates */ \"./src/js/templates.js\");\n/* harmony import */ var _tooltip__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./tooltip */ \"./src/js/tooltip.js\");\n/* harmony import */ var _ui__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./ui */ \"./src/js/ui.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n$(document).ready(() => {\n    _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].init();\n    \n    _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].init();\n    _data__WEBPACK_IMPORTED_MODULE_1__[\"default\"].init();\n    _events__WEBPACK_IMPORTED_MODULE_3__[\"default\"].init();\n    _inputs__WEBPACK_IMPORTED_MODULE_4__[\"default\"].init();\n    _panel__WEBPACK_IMPORTED_MODULE_5__[\"default\"].init();\n    _selection__WEBPACK_IMPORTED_MODULE_6__[\"default\"].init();\n    _sortable__WEBPACK_IMPORTED_MODULE_7__[\"default\"].init();\n    _stats__WEBPACK_IMPORTED_MODULE_8__[\"default\"].init();\n    _templates__WEBPACK_IMPORTED_MODULE_9__[\"default\"].init();\n    _tooltip__WEBPACK_IMPORTED_MODULE_10__[\"default\"].init();\n    _ui__WEBPACK_IMPORTED_MODULE_11__[\"default\"].init();\n});\n\n//# sourceURL=webpack:///./src/js/main.js?");

/***/ }),

/***/ "./src/js/panel.js":
/*!*************************!*\
  !*** ./src/js/panel.js ***!
  \*************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _dates__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dates */ \"./src/js/dates.js\");\n/* harmony import */ var _events__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./events */ \"./src/js/events.js\");\n/* harmony import */ var _selection__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./selection */ \"./src/js/selection.js\");\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n    isOpen: false,\n    layouts: {\n        default: `<ul>\n            <li data-tool=\"add\" class=\"selected\"><i class=\"fas fa-plus\"></i><span>Add event…</span></li>\n            <li data-tool=\"replace\"><i class=\"fas fa-exchange-alt\"></i>Replace event…</li>\n            <li data-tool=\"remove\"><i class=\"far fa-trash-alt\"></i>Remove event…</li>\n            <li data-tool=\"fill\" class=\"border-top\" disabled><i class=\"far fa-calendar-plus\"></i>Fill empty days…</li>\n            <li data-tool=\"count\" disabled><i class=\"fa fa-calculator\"></i>Count occurences…</li>\n        </ul>`,\n        add: `<div>\n            <div class=\"head\">\n                <i class=\"fas fa-plus\"></i><span>Add event…</span>\n            </div>\n            <ul></ul>\n        </div>`,\n        replace: `<div class=\"row\">\n            <div>\n                <div class=\"head\">\n                    <i class=\"fas fa-exchange-alt\"></i>Replace…\n                </div>\n                <ul class=\"from\"></ul>\n            </div>\n            <div>\n                <div class=\"head\">With…</div>\n                <ul class=\"to\"></ul>\n            </div>\n        </div>`,\n        remove: `<div>\n            <div class=\"head\">\n                <i class=\"far fa-trash-alt\"></i>Remove event…\n            </div>\n            <ul></ul>\n        </div>`,\n        count: `<div>\n            <div class=\"head\">\n                <i class=\"fa fa-calculator\"></i>Count occurences of…\n            </div>\n            <ul></ul>\n        </div>`\n    },\n\n    init() {\n        $(document).on('keypress', e => {\n            if (e.which === 13) { // Enter\n                if (!_selection__WEBPACK_IMPORTED_MODULE_2__[\"default\"].selectedDays.length) return;\n\n                if (!this.isOpen) this.openPanel();\n                else this.confirm();\n            }\n        });\n\n        $(document).on('keydown', e => {\n            if ([38, 40].includes(e.which)) { // Arrow keys\n                if (!this.isOpen) return;\n                \n                if (e.which === 38) this.previous();\n                else if (e.which === 40) this.next();\n            }\n        });\n\n        $(document).on('mouseenter', '.panel ul li:not([disabled])', e => {\n            const $el = $(e.target).closest('li');\n            $('.panel ul li.selected').removeClass('selected');\n            $el.addClass('selected');\n        });\n\n        $(document).on('click', '.panel ul li', e => {\n            const $el = $(e.currentTarget);\n            if ($el.is('[disabled]')) return false;\n            $el.siblings('.picked').removeClass('picked');\n\n            this.confirm();\n            return false;\n        });\n\n        $(document).on('click', '', () => {\n            this.closePanel();\n        });\n    },\n\n    openPanel() {\n        this.isOpen = true;\n        $('.panel').html(this.layouts['default']);\n\n        $('.panel [data-tool=\"add\"] span').text(`Add ${_selection__WEBPACK_IMPORTED_MODULE_2__[\"default\"].selectedDays.length} event${_selection__WEBPACK_IMPORTED_MODULE_2__[\"default\"].selectedDays.length > 1 ? 's' : ''}…`)\n\n        // Disable replace and remove if selection is empty\n        if (_selection__WEBPACK_IMPORTED_MODULE_2__[\"default\"].allDaysEmpty()) $('.panel li[data-tool=\"replace\"], .panel li[data-tool=\"remove\"]').attr('disabled', true);\n        $('.panel-wrap').addClass('visible');\n    },\n\n    closePanel() {\n        this.isOpen = false;\n        $('.panel-wrap').removeClass('visible');\n    },\n\n    previous() {\n        const $el = $('.panel ul li.selected');\n        $el.removeClass('selected');\n        if ($el.prev('li:not([disabled])').length) $el.prev('li:not([disabled])').addClass('selected');\n        else $el.parent('ul').find('li:not([disabled])').last().addClass('selected');\n    },\n\n    next() {\n        const $el = $('.panel ul li.selected');\n        $el.removeClass('selected');\n        if ($el.next('li:not([disabled])').length) $el.next('li:not([disabled])').addClass('selected');\n        else $el.parent('ul').find('li:not([disabled])').first().addClass('selected');\n    },\n\n    confirm() {\n        const tool = $('.panel ul li.selected').attr('data-tool');\n        let $html;\n\n        if (tool === 'add') this.addEvent();\n        else if (tool === 'add-event') this.addEvent(true);\n        else if (tool === 'replace') this.replaceEvent();\n        else if (tool === 'from-event') this.replaceEvent(true);\n        else if (tool === 'to-event') this.replaceEvent(true, true);\n        else if (tool === 'remove') this.removeEvent();\n        else if (tool === 'remove-event') this.removeEvent(true);\n\n        $('.panel').html($html);\n    },\n\n    buildEventsList(action, filter = false) {\n        const $calendars = $('.calendars-wrap').hasClass('edit-all') ? $('.calendars-wrap .calendar') : $('.calendars-wrap .calendar.selected');\n\n        let list = $('.events-wrap ul li').map((_, el) => {\n            const $el = $(el);\n            const type = $el.attr('data-type');\n            const count = _selection__WEBPACK_IMPORTED_MODULE_2__[\"default\"].selectedDays.reduce((acc, curr) => {\n                const date = _dates__WEBPACK_IMPORTED_MODULE_0__[\"default\"].toString(curr);\n                const $events = $calendars.find(`.day[data-date=\"${date}\"] .event[data-type=\"${type}\"]`);\n\n                const ids = $events.toArray().map(e => $(e).attr('data-id'));\n                ids.map(id => acc.add(id));\n\n                return acc;\n            }, new Set()).size;\n\n            return `<li data-tool=\"${action}-event\"><span class=\"event\" data-type=\"${type}\" data-color=\"${$el.attr('data-color')}\"><span class=\"title\">${$el.find('.title').text()}</span></span>${action === 'from' ? `<span class=\"count\">${count}</span>` : ''}</li>`;\n        }).toArray();\n\n        if (filter) {\n            const eventsInSelection = _selection__WEBPACK_IMPORTED_MODULE_2__[\"default\"].selectedDays.map(day => $(`.day[data-date=\"${_dates__WEBPACK_IMPORTED_MODULE_0__[\"default\"].toString(day)}\"] .event`).map((_, el) => $(el).attr('data-type')).toArray()).flat();\n            list = list.filter(li => eventsInSelection.includes($(li).find('.event').attr('data-type')));\n        }\n\n        return list;\n    },\n\n    addEvent(eventSelected = false) {\n        if (!eventSelected) {\n            const $html = $(this.layouts['add']);\n            $html.find('ul').html(this.buildEventsList('add'));\n            $html.find('li:first-child').addClass('selected');\n            $('.panel').html($html);\n            $('.panel .head span').text(`Add ${_selection__WEBPACK_IMPORTED_MODULE_2__[\"default\"].selectedDays.length} event${_selection__WEBPACK_IMPORTED_MODULE_2__[\"default\"].selectedDays.length > 1 ? 's' : ''}…`)\n        } else {\n            const $event = $('.panel li.selected .event');\n            _events__WEBPACK_IMPORTED_MODULE_1__[\"default\"].insertEvent($event);\n            this.closePanel();\n        }\n    },\n\n    replaceEvent(from, to) {\n        if (!from) {\n            // Initiate replacement window\n            const $html = $(this.layouts['replace']);\n\n            // Fill \"from\" list with options\n            $html.find('ul.from').html(this.buildEventsList('from', true));\n            $html.find('ul.from li:first-child').addClass('selected');\n            $('.panel').html($html);\n        } else if (!to) {\n            // Fill \"to\" list with options\n            $('.panel ul.to').html(this.buildEventsList('to'));\n\n            // Unselect selected \"from\" option but save it as picked\n            $('.panel ul.from li.selected').addClass('picked').removeClass('selected');\n\n            // Don't show picked \"from\" option in \"to\" options list (don't replace an event with itself)\n            $(`.panel ul.to li .event[data-type=\"${$('.panel ul.from li.picked .event').attr('data-type')}\"]`).parent('li').remove();\n\n            // Select first \"to\" option\n            $('.panel ul.to li:first-child').addClass('selected');\n        } else {\n            // Replace events\n            const from = parseInt($('.panel ul.from li.picked .event').attr('data-type'));\n            const to = parseInt($('.panel ul.to li.selected .event').attr('data-type'));\n\n            _selection__WEBPACK_IMPORTED_MODULE_2__[\"default\"].replaceEvents(from, to);\n            this.closePanel();\n        }\n    },\n\n    removeEvent(eventSelected = false) {\n        if (!eventSelected) {\n            const $html = $(this.layouts['remove']);\n            $html.find('ul').html(this.buildEventsList('remove', true));\n            $html.find('li:first-child').addClass('selected');\n            $('.panel').html($html);\n        } else {\n            // Remove events\n            const type = parseInt($('.panel ul li.selected .event').attr('data-type'));\n            _selection__WEBPACK_IMPORTED_MODULE_2__[\"default\"].removeEvents(type);\n            this.closePanel();\n        }\n    }\n});\n\n//# sourceURL=webpack:///./src/js/panel.js?");

/***/ }),

/***/ "./src/js/selection.js":
/*!*****************************!*\
  !*** ./src/js/selection.js ***!
  \*****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _calendars__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./calendars */ \"./src/js/calendars.js\");\n/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./data */ \"./src/js/data.js\");\n/* harmony import */ var _dates__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./dates */ \"./src/js/dates.js\");\n/* harmony import */ var _events__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./events */ \"./src/js/events.js\");\n/* harmony import */ var _history__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./history */ \"./src/js/history.js\");\n/* harmony import */ var _stats__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./stats */ \"./src/js/stats.js\");\n/* harmony import */ var _ui__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./ui */ \"./src/js/ui.js\");\n\n\n\n\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n    selectedDays: [],\n    clipboard: [],\n    lastHoveredDate: null,\n    drawing: false,\n    resizing: false,\n    event: null,\n    eventID: null,\n    eventTitle: null,\n\n    init() {\n        // Click on a day in main calendar\n        $(document).on('mousedown', '.calendar-wrap .day', e => {\n            if (_ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].toolIs('draw')) {\n                if (this.event) this.changeType();\n                this.startDraw(e);\n            }\n            else if (_ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].tool === 'select') this.select(e);\n        });\n\n        // Double-click on a day in main calendar\n        $(document).on('dblclick', '.calendar-wrap .day', e => {\n            if (_ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].toolIs('draw')) {\n                this.startDraw(e);\n                this.draw(e);\n                this.endDraw();\n            }\n        });\n\n        // Release click on a day in main calendar\n        $(document).on('mouseup', '.calendar-wrap .day', () => {\n            if (_ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].toolIs('draw')) {\n                if (this.drawing) this.endDraw();\n                else if (this.dragging) this.endDrag();\n                else if (this.resizing) this.endResize();\n            }\n        });\n\n        // Mouse enters a day in main calendar\n        $(document).on('mouseenter', '.calendar-wrap .day', e => {\n            if (_ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].toolIs('draw')) {\n                if (this.drawing) this.draw(e);\n                else if (this.dragging) this.dragEvent(e);\n                else if (this.resizing) this.resizeEvent(e);\n            } else if (_ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].tool === 'select') {\n                const date = $(e.currentTarget).attr('data-date');\n                this.lastHoveredDate = date;\n    \n                if (this.selectedDays.length) this.dragSelect(e);\n            }\n        });\n\n        // Change new event title\n        $(document).on('input', '.event.new .title', e => {\n            const $el = $(e.currentTarget);\n            this.renameEvent($el);\n        });\n\n        // Hover new event type option\n        $(document).on('mouseenter', '.new-event ul li', e => {\n            const $el = $(e.currentTarget);\n            $('.new-event ul li.selected').removeClass('selected');\n            $el.addClass('selected');\n        });\n\n        // Click on new event type option\n        $(document).on('click', '.new-event ul li', e => {\n            const type = parseInt($(e.currentTarget).attr('data-type'));\n            this.changeType(type);\n        });\n\n        $(document).on('mousedown', '.new-event ul li', () => {\n            return false;\n        });\n\n        // Up/down arrow keys + enter key in new event type options\n        $(document).on('keydown', e => {\n            if (!this.event) return;\n            const $li = $('.new-event ul li.selected');\n            \n            if (e.which === 38) { // Up\n                if ($li.length) {\n                    if ($li.prev('li').length) $li.prev('li').addClass('selected');\n                    else $('.new-event ul li:last-child').addClass('selected');\n                    $li.removeClass('selected');\n                } else {\n                    $('.new-event ul li:last-child').addClass('selected');\n                }\n            } else if (e.which === 40) { // Down\n                if ($li.length) {\n                    if ($li.next('li').length) $li.next('li').addClass('selected');\n                    else $('.new-event ul li:first-child').addClass('selected');\n                    $li.removeClass('selected');\n                } else {\n                    $('.new-event ul li:first-child').addClass('selected');\n                }\n            } else if (e.which === 13) { // Enter\n                if ($li.length && $('.new-event').hasClass('visible')) {\n                    const type = parseInt($li.attr('data-type'));\n                    this.changeType(type);\n                } else {\n                    this.changeType();\n                }\n            }\n        });\n\n        // Click on an event in main calendar\n        $(document).on('mousedown', '.calendar-wrap .day .event:not(.new)', e => {\n            if (_ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].toolIs('draw')) return false;\n        });\n\n        // Release click on an event in main calendar\n        $(document).on('mouseup', '.calendar-wrap .day .event', () => {\n            if (_ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].toolIs('draw') && !this.event) return false;\n        });\n\n        // Double-click on an event in main calendar\n        $(document).on('dblclick', '.calendar-wrap .day .event', e => {\n            if (_ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].toolIs('draw')) {\n                const $event = $(`.calendar-wrap .event.start[data-id=\"${$(e.currentTarget).attr('data-id')}\"]`);\n\n                $('.new-event').css({\n                    'top': $event.offset().top + $event.outerHeight() + 8,\n                    'left': $event.offset().left\n                })\n                .html(this.buildEventsTypesOptions(_events__WEBPACK_IMPORTED_MODULE_3__[\"default\"].data))\n                .addClass('visible');\n\n                return false;\n            }\n        });\n\n        // Mousedown outside calendar submits new event\n        $(document).on('mousedown', '.calendar-wrap .event', e => {\n            if (_ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].toolIs('draw')) {\n                const $event = $(e.currentTarget);\n\n                if (this.event) this.changeType();\n                else {\n                    this.dragging = true;\n\n                    const id = parseInt($event.attr('data-id'));\n\n                    this.event = {\n                        id,\n                        calendar: parseInt($event.closest('.calendar').attr('data-id')),\n                        type: parseInt($event.attr('data-type')),\n                        start: $(`.event.start[data-id=\"${id}\"]`).closest('.day').attr('data-date'),\n                        end: $(`.event.end[data-id=\"${id}\"]`).closest('.day').attr('data-date'),\n                        dragging: $event.closest('.day').attr('data-date')\n                    };\n                }\n\n                const multiSelect = e.metaKey || e.ctrlKey || e.shiftKey;\n                if (!multiSelect) $('.event.selected').removeClass('selected');\n                $('.new-event').removeClass('visible');\n\n                const id = $event.attr('data-id');\n                if (!isNaN(id)) this.selectEventByID(id);\n                return false;\n            }\n        });\n\n        // Mousedown anywhere\n        $(document).on('mousedown', e => {\n            // Click outside calendar submits new event\n            // if (this.event && !$(e.target).closest('.calendar-wrap .calendar').length) this.changeType();\n\n            $('.new-event').removeClass('visible');\n            $('.event.selected').removeClass('selected');\n        });\n\n        $(document).on('mousedown', '.calendar-wrap .event .anchor', e => {\n            $('.new-event').removeClass('visible');\n            this.resizing = true;\n            \n            const $anchor = $(e.currentTarget);\n            const $event = $anchor.closest('.event');\n\n            const id = parseInt($event.attr('data-id'));\n\n            this.event = {\n                id,\n                calendar: parseInt($event.closest('.calendar').attr('data-id')),\n                type: parseInt($event.attr('data-type')),\n                start: $(`.event.start[data-id=\"${id}\"]`).closest('.day').attr('data-date'),\n                end: $(`.event.end[data-id=\"${id}\"]`).closest('.day').attr('data-date'),\n                anchor: $anchor.hasClass('anchor-start') ? 'start' : 'end'\n            };\n\n            $event.closest('.calendar').addClass('resizing');\n\n            return false;\n        });\n\n        $(document).on('mouseup', () => {\n            if (this.dragging) this.endDrag();\n            else if (this.resizing) this.endResize();\n        });\n\n        $(document).on('dblclick', '.calendar-wrap .event .anchor', () => {\n            return false;\n        });\n    },\n\n    startDraw(e) {\n        this.drawing = true;\n\n        const $day = $(e.currentTarget);\n        const date = $day.attr('data-date');\n\n        this.event = {\n            id: ++_events__WEBPACK_IMPORTED_MODULE_3__[\"default\"].eventID,\n            calendar: parseInt($day.parents('.calendar').attr('data-id')),\n            start: date,\n            end: date,\n            startingDate: date\n        };\n\n        this.eventID = this.event.id;\n    },\n\n    draw(e) {\n        const $day = $(e.currentTarget);\n        const date = $day.attr('data-date');\n\n        if (date >= this.event.startingDate) {\n            this.event.start = this.event.startingDate;\n            this.event.end = date;\n        } else if (date < this.event.startingDate) {\n            this.event.start = date;\n            this.event.end = this.event.startingDate;\n        }\n\n        _events__WEBPACK_IMPORTED_MODULE_3__[\"default\"].updateEvent(this.event);\n    },\n\n    endDraw() {\n        if (!this.event) return;\n        this.drawing = false;\n        \n        // Find new event start\n        const $event = $(`.calendar-wrap .event.new.start[data-id=\"${this.event.id}\"]`);\n\n        // Ignore single click\n        if (!$event.length) {\n            this.event = null;\n            _events__WEBPACK_IMPORTED_MODULE_3__[\"default\"].eventID--;\n            return;\n        }\n\n        const $title = $event.find('.title');\n        $title.attr('contenteditable', true).focus();\n\n        if (!_events__WEBPACK_IMPORTED_MODULE_3__[\"default\"].data.length) return;\n\n        $('.new-event').css({\n            'top': $event.offset().top + $event.outerHeight() + 8,\n            'left': $event.offset().left\n        })\n        .html(this.buildEventsTypesOptions(_events__WEBPACK_IMPORTED_MODULE_3__[\"default\"].data))\n        .addClass('visible');\n    },\n\n    cancelDraw() {\n        this.event = null;\n        _events__WEBPACK_IMPORTED_MODULE_3__[\"default\"].eventID--;\n        _events__WEBPACK_IMPORTED_MODULE_3__[\"default\"].removeEvent({id: this.eventID });\n        $('.new-event').removeClass('visible');\n    },\n\n    renameEvent($el) {\n        const title = $el.text();\n\n        this.eventTitle = title;\n\n        this.filterTypes(title);\n\n        // Duplicate text to other title fields (event on multiple weeks)\n        const id = $el.closest('.event').attr('data-id');\n        $(`.event[data-id=\"${id}\"] .title:not(:focus)`).text(title);\n    },\n\n    changeType(type) {\n        let event;\n        let calendar;\n\n        if (typeof this.eventID === 'number') {\n            calendar = _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].data.find(c => c.events.some(e => e.id === this.eventID));\n            event = calendar.events.find(e => e.id === this.eventID);\n        } else {\n            const $event = $('.calendar-wrap .event.start.selected').eq(0);\n            const eventID = parseInt($event.attr('data-id'));\n            calendar = _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].data.find(c => c.events.some(e => e.id === eventID));\n            event = calendar.events.find(e => e.id === eventID);\n        }\n\n        if (isNaN(type)) {\n            // New event\n            _events__WEBPACK_IMPORTED_MODULE_3__[\"default\"].newEvent({\n                title: this.eventTitle || 'New event',\n                color: 17\n            });\n            event.type = _events__WEBPACK_IMPORTED_MODULE_3__[\"default\"].type;\n        } else {\n            event.type = type;\n        }\n\n        event.calendar = calendar.id;\n        _events__WEBPACK_IMPORTED_MODULE_3__[\"default\"].updateEvent(event);\n\n        $('.new-event').removeClass('visible');\n\n        this.event = null;\n        this.eventID = null;\n\n        _stats__WEBPACK_IMPORTED_MODULE_5__[\"default\"].update();\n        _data__WEBPACK_IMPORTED_MODULE_1__[\"default\"].save();\n    },\n\n    filterTypes(title) {\n        let eventsList = _events__WEBPACK_IMPORTED_MODULE_3__[\"default\"].data;\n        eventsList = eventsList.filter(e => e.title.toLowerCase().startsWith(title.toLowerCase()));\n\n        if (eventsList.length) $('.new-event').html(this.buildEventsTypesOptions(eventsList)).addClass('visible');\n        else $('.new-event').removeClass('visible');\n    },\n\n    buildEventsTypesOptions(events) {\n        return `<ul>${events.map(e => `<li data-type=\"${e.type}\"><span class=\"event-icon\" data-color=\"${e.color}\"></span>${e.title}</li>`).join('')}</ul>`;\n    },\n\n    select(e) {\n        const $day = $(e.currentTarget);\n        const date = $day.attr('data-date');\n\n        $('.calendar.selected').removeClass('selected');\n        $(`.calendar[data-id=\"${$day.closest('.calendar').attr('data-id')}\"]`).addClass('selected');\n\n        if (e.metaKey && !e.shiftKey && !e.altKey) {\n            $('.selected-first').removeClass('selected-first');\n            $day.addClass('selected-first');\n\n            if (_dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].isInArray(this.selectedDays, new Date(date))) {\n                this.selectedDays = this.selectedDays.filter(d => d.getTime() !== new Date(date).getTime());\n            } else {\n                this.selectedDays.push(new Date(date));\n            }\n        } else if (e.shiftKey) {\n            const $selectedFirst = $('.calendar-wrap .day.selected-first').length ? $('.calendar-wrap .day.selected-first') : $('.calendar-wrap .day.selected').eq(0);\n            $selectedFirst.addClass('selected-first');\n\n            let days = [];\n            const [start, end] = [new Date($selectedFirst.attr('data-date')), new Date($day.attr('data-date'))].sort((a, b) => a > b ? 1 : -1);\n\n            if (_ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].viewIs('full')) {\n                const _selectedDays = [new Date($selectedFirst.attr('data-date')), new Date(date)];\n    \n                const lowestWeekDay = Math.min(..._selectedDays.map(d => d.getDay()).map(w => w === 0 ? 7 : w));\n                const highestWeekDay = Math.max(..._selectedDays.map(d => d.getDay()).map(w => w === 0 ? 7 : w));\n    \n    \n                start.setDate(start.getDate() - ((start.getDay() === 0 ? 7 : start.getDay()) - lowestWeekDay));\n                end.setDate(end.getDate() + (highestWeekDay - (end.getDay() === 0 ? 7 : end.getDay())));\n                \n                days = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].range(start, end);\n    \n                // Filter out days out of rectangle\n                days = days.filter(d => (d.getDay() === 0 ? 7 : d.getDay()) >= lowestWeekDay && (d.getDay() === 0 ? 7 : d.getDay()) <= highestWeekDay);\n            } else {\n                days = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].range(start, end);\n            }\n\n            if (e.metaKey) this.selectedDays.push(...days);\n            else this.selectedDays = days;\n        } else if (e.altKey) {\n            const $selectedFirst = $('.calendar-wrap .day.selected-first').length ? $('.calendar-wrap .day.selected-first') : $('.calendar-wrap .day.selected').eq(0);\n            $selectedFirst.addClass('selected-first');\n\n            const [start, end] = [new Date($selectedFirst.attr('data-date')), new Date($day.attr('data-date'))].sort((a, b) => a > b ? 1 : -1);\n\n            const days = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].range(start, end);\n\n            if (e.metaKey) this.selectedDays.push(...days);\n            else this.selectedDays = days;\n        } else {\n            // if (this.selectedDays.length && this.selectedDays[0].getTime() === new Date(date).getTime()) {\n            //     this.selectedDays = []; \n            // } else {\n                this.selectedDays = [new Date(date)]; \n                $('.calendar-wrap .day.selected-first').removeClass('selected-first');\n                $('.calendar-wrap .day.selected-last').removeClass('selected-last');\n                $day.addClass('selected-first selected-last');\n            // }\n        }\n\n        this.highlightSelection();\n    },\n\n    dragSelect(e) {\n        if (!(e.which === 1 || e.which === 18)) return;\n\n        let date;\n        if (e.which === 18) date = this.lastHoveredDate;\n        else if (e.which === 1) date = $(e.currentTarget).attr('data-date');\n\n        const $selectedFirst = $('.calendar-wrap .day.selected-first').length ? $('.calendar-wrap .day.selected-first') : $('.calendar-wrap .day.selected').eq(0);\n        $selectedFirst.addClass('selected-first');\n\n        let days = [];\n\n        if (e.metaKey) {\n            this.selectedDays.push(new Date(date));\n        } else {\n            const [start, end] = [new Date($selectedFirst.attr('data-date')), new Date(date)].sort((a, b) => a > b ? 1 : -1);\n\n            if (_ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].viewIs('full')) {\n                const _selectedDays = [new Date($selectedFirst.attr('data-date')), new Date(date)];\n    \n                const lowestWeekDay = Math.min(..._selectedDays.map(d => d.getDay()).map(w => w === 0 ? 7 : w));\n                const highestWeekDay = Math.max(..._selectedDays.map(d => d.getDay()).map(w => w === 0 ? 7 : w));\n                \n                if (!e.altKey) {\n                    // Rectangle mode, move start date to top left corner and end date to bottom right corner\n                    start.setDate(start.getDate() - ((start.getDay() === 0 ? 7 : start.getDay()) - lowestWeekDay));\n                    end.setDate(end.getDate() + (highestWeekDay - (end.getDay() === 0 ? 7 : end.getDay())));\n                }\n                \n                days = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].range(start, end);\n\n                // Filter out days out of rectangle\n                if (!e.altKey) days = days.filter(d => (d.getDay() === 0 ? 7 : d.getDay()) >= lowestWeekDay && (d.getDay() === 0 ? 7 : d.getDay()) <= highestWeekDay);\n            } else {\n                days = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].range(start, end);\n            }\n        }   \n\n        if (!$selectedFirst.hasClass('selected')) {\n            this.selectedDays = this.selectedDays.filter(d => d.getTime() !== new Date(date).getTime());\n        } else {\n            if (e.metaKey) this.selectedDays.push(...days);\n            else this.selectedDays = days;\n        }\n\n        this.highlightSelection();\n    },\n\n    moveSelection(e) {\n        // Ignore if no selection\n        const $selected = $('.calendar-wrap .day.selected-last');\n        if (!$selected.length) return;\n    \n        // Target set to same date by default (for linear mode)\n        const date = new Date($selected.attr('data-date'));\n        let target = date;\n    \n        if (e.which === 37) {\n            if (e.metaKey) { // Meta + left\n                // Full: beginning of week\n                if (_ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].viewIs('full')) target = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].relativeFirstWeekDay(date);\n\n                // Linear: one week before\n                else if (_ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].viewIs('linear')) target = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].relativeDate(date, -7);\n\n            } else { // Left\n\n                // One day before\n                target = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].relativeDate(date, -1);\n                \n                // Prevent changing week with shift key\n                if (_ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].viewIs('full') && target.getDay() === 0 && e.shiftKey) return;\n            }\n\n        } else if (e.which === 38) { // Up\n\n            // Full: one week before\n            if (_ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].viewIs('full')) target = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].relativeDate(date, -7);\n\n            // Linear: calendar above\n            else if (_ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].viewIs('linear')) _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].selectPreviousCalendar();\n\n        } else if (e.which === 39) {\n            if (e.metaKey) { // Meta + right\n\n                // Full: end of week\n                if (_ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].viewIs('full')) target = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].relativeLastWeekDay(date);\n\n                // Linear: one week after\n                else if (_ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].viewIs('linear')) target = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].relativeDate(date, 7);\n\n            } else { // Right\n                \n                // One day after\n                target = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].relativeDate(date, 1);\n        \n                // Prevent changing week with shift key\n                if (_ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].viewIs('full') && target.getDay() === 1 && e.shiftKey) return;\n            }\n\n        } else if (e.which === 40) { // Down\n            // Full: one week after\n            if (_ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].viewIs('full')) target = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].relativeDate(date, 7);\n            \n            // Linear: move to calendar under\n            else if (_ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].viewIs('linear')) _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].selectNextCalendar();\n        }\n    \n        if (e.shiftKey) {\n            const $selectedFirst = $('.selected-first');\n            $('.selected-last').removeClass('selected-last');\n    \n            const targetDate = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].toString(target);\n            const $target = $(`.calendar-wrap .day[data-date=\"${targetDate}\"]`);\n            $target.addClass('selected-last');\n    \n            this.selectedDays = [new Date($selectedFirst.attr('data-date')), new Date(targetDate)];\n\n            const [start, end] = [new Date($selectedFirst.attr('data-date')), new Date(target)].sort((a, b) => a > b ? 1 : -1);\n            let days = [];\n\n            if (_ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].viewIs('full')) {\n                const lowestWeekDay = Math.min(...this.selectedDays.map(d => d.getDay()).map(w => w === 0 ? 7 : w));\n                const highestWeekDay = Math.max(...this.selectedDays.map(d => d.getDay()).map(w => w === 0 ? 7 : w));\n        \n                start.setDate(start.getDate() - ((start.getDay() === 0 ? 7 : start.getDay()) - lowestWeekDay));\n                end.setDate(end.getDate() + (highestWeekDay - (end.getDay() === 0 ? 7 : end.getDay())));\n                \n                days = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].range(start, end);\n        \n                // Filter out days out of rectangle\n                days = days.filter(d => (d.getDay() === 0 ? 7 : d.getDay()) >= lowestWeekDay && (d.getDay() === 0 ? 7 : d.getDay()) <= highestWeekDay);\n            } else {\n                days = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].range(start, end);\n            }\n    \n            this.selectedDays = days;\n        } else if (e.altKey) {\n            const $selectedFirst = $('.selected-first');\n            $('.selected-last').removeClass('selected-last');\n    \n            const targetDate = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].toString(target);\n            const $target = $(`.calendar-wrap .day[data-date=\"${targetDate}\"]`);\n            $target.addClass('selected-last');\n    \n            const [start, end] = [new Date($selectedFirst.attr('data-date')), new Date(target)].sort((a, b) => a > b ? 1 : -1);\n    \n            const days = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].range(start, end);\n    \n            this.selectedDays = days;\n        } else {\n            const diff = target - date;\n\n            // Move .selected-first and .selected-last classes\n            const $sF = $('.selected-first');\n            const dateSF = new Date($sF.attr('data-date'));\n            dateSF.setTime(dateSF.getTime() + diff);\n            $sF.removeClass('selected-first');\n            $(`.calendar-wrap .day[data-date=${_dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].toString(dateSF)}]`).addClass('selected-first');\n\n            const $sL = $('.selected-last');\n            const dateSL = new Date($sL.attr('data-date'));\n            dateSL.setTime(dateSL.getTime() + diff);\n            $sL.removeClass('selected-last');\n            $(`.calendar-wrap .day[data-date=${_dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].toString(dateSL)}]`).addClass('selected-last');\n\n            // For each already selected day, move by diff between first selected day and target\n            this.selectedDays = this.selectedDays.map(date => new Date(date.getTime() + diff));\n        }\n    \n        this.highlightSelection();\n    },\n\n    emptySelection() {\n        // Create action for history\n        const action = {\n            type: 'removeEvents',\n            events: []\n        };\n\n        const removeEvents = $events => {\n            $events.each((_, el) => {\n                const $el = $(el);\n\n                const id = parseInt($el.attr('data-id'));\n                const start = $(`.event[data-id=\"${id}\"].start`).closest('.day').attr('data-date');\n                const end = $(`.event[data-id=\"${id}\"].end`).closest('.day').attr('data-date');\n\n                if (!start || !end) return;\n                \n                const event = {\n                    id,\n                    calendar: parseInt($el.parents('.calendar').attr('data-id')),\n                    type: parseInt($el.attr('data-type')),\n                    start,\n                    end\n                };\n                \n                _events__WEBPACK_IMPORTED_MODULE_3__[\"default\"].removeEvent(event);\n                \n                // Save events in action\n                action.events.push(event);\n            });\n        }\n        \n        if (_ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].toolIs('draw')) {\n            const $events = $('.event.selected');\n            removeEvents($events);    \n        }\n        else if (_ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].tool === 'select') {\n            for (const day of this.selectedDays) {\n                const date = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].toString(day);\n                let $events;\n                if ($('.calendars-wrap').hasClass('edit-all')) {\n                    $events = $(`.calendars-wrap .day[data-date=\"${date}\"] .event`);\n                } else {\n                    $events = $(`.calendars-wrap .calendar.selected .day[data-date=\"${date}\"] .event`);\n                }\n\n                if (!$events.length) continue;\n                removeEvents($events);\n            }\n        }\n    \n        // Save action in history\n        _history__WEBPACK_IMPORTED_MODULE_4__[\"default\"].pushAction(action);\n\n        _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].updateCalendarHeight();\n        _stats__WEBPACK_IMPORTED_MODULE_5__[\"default\"].update();\n        _data__WEBPACK_IMPORTED_MODULE_1__[\"default\"].save();\n    },\n    \n    selectAll() {\n        const start = new Date($('#start').val());\n        const end = new Date($('#end').val());\n\n        this.selectedDays = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].range(start, end);\n\n        this.highlightSelection();\n    },\n\n    narrowSelection() {\n        const $onlySelectedDay = $('.selected-first.selected-last.selected');\n\n        // Keep only first selected day in selection\n        const $selectedFirst = $('.selected-first');\n        const date = new Date($selectedFirst.attr('data-date'));\n\n        $('.selected-last').removeClass('selected-last');\n        $selectedFirst.addClass('selected-last');\n        \n        this.selectedDays = [date];\n        this.highlightSelection();\n        \n        // If only one selected day, toggle it\n        $onlySelectedDay.removeClass('selected');\n\n        $('.new-event').removeClass('visible');\n    },\n        \n    copySelection() {\n        this.clipboard = [];\n    \n        // Find selection's bounding rectangle\n        let start = new Date(Math.min(...this.selectedDays));\n        let end = new Date(Math.max(...this.selectedDays));\n\n        const lowestWeekDay = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].findLowestWeekDay(this.selectedDays);\n        const highestWeekDay = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].findHighestWeekDay(this.selectedDays);\n    \n        start.setDate(start.getDate() - ((start.getDay() === 0 ? 7 : start.getDay()) - lowestWeekDay));\n        end.setDate(end.getDate() + (highestWeekDay - (end.getDay() === 0 ? 7 : end.getDay())));\n    \n        // Create range from start to end of bounding rectangle\n        let days = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].range(start, end);\n    \n        // Filter out days out of bounding rectangle\n        days = days.filter(d => (d.getDay() === 0 ? 7 : d.getDay()) >= lowestWeekDay && (d.getDay() === 0 ? 7 : d.getDay()) <= highestWeekDay);\n    \n        // Create array of events for selected days, keep null for an empty day\n        const events = [];\n        for (const day of days) {\n            const eventsThatDay = [];\n\n            // Ignore unselected days\n            if (!_dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].isInArray(this.selectedDays, day)) {\n                events.push(null);\n                continue;\n            };\n    \n            const date = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].toString(day);\n            const $events = $(`.calendar-wrap .day[data-date=\"${date}\"] .event`);\n    \n            // Copy day events to clipboard\n            if ($events.length) {\n                $events.each((_, el) => {\n                    const $el = $(el);\n        \n                    const event = {\n                        // id: \n                        type: parseInt($el.attr('data-type')),\n                        // title: $el.find('.title').text(),\n                        // color: $el.css('background-color'),\n                        // start: $el.attr('data-start'),\n                        // end: $el.attr('data-end')\n                    }\n        \n                    eventsThatDay.push(event);\n                });\n                events.push(eventsThatDay);\n\n            } else {\n                events.push(null);\n            }\n        }\n    \n        // Convert 1D array of events to 2D array to mimic selection bounding rectangle layout\n        while (events.length) this.clipboard.push(events.splice(0, highestWeekDay - lowestWeekDay + 1));\n\n        if (this.clipboard.length) $('nav [data-tool=\"paste\"').removeClass('disabled');\n        else $('nav [data-tool=\"paste\"').addClass('disabled');\n    },\n    \n    cutSelection() {\n        this.copySelection();\n        this.emptySelection();\n    },\n    \n    pasteSelection() {\n        // Push action in history\n        const action = {\n            type: 'addEvents',\n            events: []\n        };\n\n        // Clipboard paste starts at selected day\n        const $selected = $('.calendar-wrap .day.selected-first');\n        const date = new Date($selected.attr('data-date'));\n    \n        for (let j = 0; j < this.clipboard.length; j += 1) {\n            for (let i = 0; i < this.clipboard[0].length; i += 1) {\n                // Find event in clipboard if any\n                const eventsThatDay = this.clipboard[j][i];\n                if (!eventsThatDay) continue;\n\n                for (const _event of eventsThatDay) {\n                    // Find target day\n                    const target = new Date(new Date(date).setDate(date.getDate() + j * 7 + i));\n                    const eventDate = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].toString(target);\n\n                    // Create event\n                    const event = {\n                        ..._event,\n                        id: ++_events__WEBPACK_IMPORTED_MODULE_3__[\"default\"].eventID,\n                        start: eventDate,\n                        end: eventDate\n                    };\n            \n                    // Build event\n                    _events__WEBPACK_IMPORTED_MODULE_3__[\"default\"].buildEvent(event);\n        \n                    // Save event in action\n                    action.events.push(event);\n                }\n            }\n        }\n\n        // Save action in history\n        _history__WEBPACK_IMPORTED_MODULE_4__[\"default\"].pushAction(action);\n\n        _stats__WEBPACK_IMPORTED_MODULE_5__[\"default\"].update();\n    },\n\n    highlightSelection() {\n        // Reset all currently selected days\n        $('.day.selected').removeClass('selected no-top no-right no-bottom no-left');\n\n        $('.event.selected').removeClass('selected');\n        const selectedEvents = new Set();\n\n        for (const day of this.selectedDays) {\n            const date = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].toString(day);\n            const $el = $(`main:not(.linear) .calendar .day[data-date=\"${date}\"], main.linear .calendar.selected .day[data-date=\"${date}\"]`);\n\n            // Select day\n            $el.addClass('selected');\n            \n            // Add styles classes (for borders)\n            const dayBeforeSelected = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].isInArray(this.selectedDays, _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].relativeDate(day, -1));\n            const dayAfterSelected = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].isInArray(this.selectedDays, _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].relativeDate(day, 1));\n\n            if (_ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].viewIs('full')) {\n                const dayWeekBeforeSelected = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].isInArray(this.selectedDays, _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].relativeDate(day, -7));\n                const dayWeekAfterSelected = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].isInArray(this.selectedDays, _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].relativeDate(day, 7));\n                \n                if (dayBeforeSelected && day.getDay() !== 1) $el.addClass('no-left');\n                if (dayAfterSelected && day.getDay() !== 0) $el.addClass('no-right');\n                if (dayWeekBeforeSelected) $el.addClass('no-top');\n                if (dayWeekAfterSelected) $el.addClass('no-bottom');\n            }\n            else if (_ui__WEBPACK_IMPORTED_MODULE_6__[\"default\"].viewIs('linear')) {\n                if (dayBeforeSelected) $el.addClass('no-left');\n                if (dayAfterSelected) $el.addClass('no-right');\n            }\n\n            const $events = $(`.calendar-wrap .day[data-date=\"${date}\"] .event`);\n            $events.each((_, el) => {\n                const id = parseInt($(el).attr('data-id'));\n                if (!isNaN(id)) selectedEvents.add(id);\n            });\n        }\n\n        for (const eventID of [...selectedEvents]) {\n            // this.selectEventByID(eventID);\n        }\n\n        if (this.selectedDays.length || $('.event.selected').length) {\n            $('nav [data-tool=\"cut\"]').removeClass('disabled');\n            $('nav [data-tool=\"copy\"]').removeClass('disabled');\n        } else {\n            $('nav [data-tool=\"cut\"]').addClass('disabled');\n            $('nav [data-tool=\"copy\"]').addClass('disabled');\n        }\n    },\n\n    replaceEvents(from, to) {\n        // Create action for history\n        const action = {\n            type: 'replaceEvents',\n            events: []\n        };\n\n        for (const day of this.selectedDays) {\n            const date = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].toString(day);\n            const $events = $('.calendars-wrap').hasClass('edit-all') ? $(`.day[data-date=\"${date}\"] .event[data-type=\"${from}\"]`) : $(`.calendar.selected .day[data-date=\"${date}\"] .event[data-type=\"${from}\"]`);\n\n            $events.each((_, el) => {\n                const $el = $(el);\n\n                const event = {\n                    id: parseInt($el.attr('data-id')),\n                    calendar: parseInt($el.closest('.calendar').attr('data-id')),\n                    type: to,\n                    from,\n                    start: date,\n                    end: date\n                };\n\n                // Replace event\n                _events__WEBPACK_IMPORTED_MODULE_3__[\"default\"].replaceEvent(event);\n\n                // Save event in action\n                action.events.push(event);\n            });\n        }\n\n        // Save action in history\n        _history__WEBPACK_IMPORTED_MODULE_4__[\"default\"].pushAction(action);\n\n        _data__WEBPACK_IMPORTED_MODULE_1__[\"default\"].save();\n    },\n\n    removeEvents(type) {\n        // Create action for history\n        const action = {\n            type: 'removeEvents',\n            events: []\n        };\n\n        for (const day of this.selectedDays) {\n            const date = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].toString(day);\n            const $events = $('.calendars-wrap').hasClass('edit-all') ? $(`.day[data-date=\"${date}\"] .event[data-type=\"${type}\"]`) : $(`.calendar.selected .day[data-date=\"${date}\"] .event[data-type=\"${type}\"]`);\n\n            $events.each((_, el) => {\n                const $el = $(el);\n\n                const event = {\n                    id: parseInt($el.attr('data-id')),\n                    calendar: parseInt($el.closest('.calendar').attr('data-id')),\n                    type: parseInt($el.attr('data-type')),\n                    start: date,\n                    end: date\n                };\n\n                // Remove event\n                _events__WEBPACK_IMPORTED_MODULE_3__[\"default\"].removeEvent(event);\n\n                // Save event in action\n                action.events.push(event);\n            });\n        }\n\n        // Save action in history\n        _history__WEBPACK_IMPORTED_MODULE_4__[\"default\"].pushAction(action);\n\n        _data__WEBPACK_IMPORTED_MODULE_1__[\"default\"].save();\n    },\n\n    allDaysEmpty() {\n        if ($('.calendars-wrap').hasClass('edit-all')) {\n            return !this.selectedDays.some(day => $(`.day[data-date=\"${_dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].toString(day)}\"] .event`).length);\n        } else {\n            return !this.selectedDays.some(day => $(`.calendar.selected .day[data-date=\"${_dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].toString(day)}\"] .event`).length);\n        }\n    },\n\n    selectEventByID(id) {\n        const $event = $(`.calendar-wrap .event[data-id=\"${id}\"]`);\n        $event.addClass('selected');\n    },\n\n    dragEvent(e) {\n        const $day = $(e.currentTarget);\n        const date = $day.attr('data-date');\n\n        const delta = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].delta(this.event.dragging, date);\n\n        this.event.start = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].relativeDate(new Date(this.event.start), delta);\n        this.event.end = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].relativeDate(new Date(this.event.end), delta);\n        this.event.dragging = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].relativeDate(new Date(this.event.dragging), delta);\n\n        _events__WEBPACK_IMPORTED_MODULE_3__[\"default\"].updateEvent(this.event);\n\n        this.selectEventByID(this.event.id);\n    },\n\n    endDrag() {\n        this.event = null;\n\n        this.dragging = false;\n\n        _data__WEBPACK_IMPORTED_MODULE_1__[\"default\"].save();\n    },\n\n    resizeEvent(e) {\n        const $day = $(e.currentTarget);\n        const date = $day.attr('data-date');\n\n        if (this.event.anchor === 'start' && date <= this.event.end) this.event.start = date;\n        else if (this.event.anchor === 'end' && date >= this.event.start) this.event.end = date;\n        \n        _events__WEBPACK_IMPORTED_MODULE_3__[\"default\"].updateEvent(this.event);\n    },\n\n    endResize() {\n        this.event = null;\n        \n        this.resizing = false;\n        $('.calendar.resizing').removeClass('resizing');\n\n        _data__WEBPACK_IMPORTED_MODULE_1__[\"default\"].save();\n    }\n});\n\n//# sourceURL=webpack:///./src/js/selection.js?");

/***/ }),

/***/ "./src/js/settings.js":
/*!****************************!*\
  !*** ./src/js/settings.js ***!
  \****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n    // spreadOnDrag: false,\n    oneEventPerDay: false,\n    // eventsColors: [\n    //     'hsl(0, 55%, 45%)',    // A\n    //     'hsl(334, 60%, 38%)',  // B\n    //     'hsl(277, 60%, 35%)',  // C\n    //     'hsl(255, 61%, 39%)',  // D\n    //     'hsl(233, 57%, 37%)',  // E\n    //     'hsl(210, 65%, 40%)',  // F\n    //     'hsl(202, 98%, 47%)',  // G\n    //     'hsl(185, 100%, 28%)', // H\n    //     'hsl(173, 100%, 21%)', // I\n    //     'hsl(123, 56%, 35%)',  // J\n    //     'hsl(95, 69%, 23%)',   // K\n    //     'hsl(60, 83%, 28%)',   // L\n    //     'hsl(43, 90%, 46%)',   // M\n    //     'hsl(34, 80%, 40%)',   // N\n    //     'hsl(14, 70%, 40%)',   // O\n    //     'hsl(27, 80%, 27%)',   // P\n    //     'hsl(11, 36%, 24%)',   // Q\n    //     'hsl(0, 0%, 52%)',     // R\n    //     'hsl(0, 0%, 38%)',     // S\n    //     'hsl(0, 0%, 23%)',     // T\n    // ],\n    template: 'filled'\n});\n\n//# sourceURL=webpack:///./src/js/settings.js?");

/***/ }),

/***/ "./src/js/sortable.js":
/*!****************************!*\
  !*** ./src/js/sortable.js ***!
  \****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _calendars__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./calendars */ \"./src/js/calendars.js\");\n/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./data */ \"./src/js/data.js\");\n/* harmony import */ var _events__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./events */ \"./src/js/events.js\");\n/* harmony import */ var _stats__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./stats */ \"./src/js/stats.js\");\n\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n    $sortedEl: null,\n    sortedPosition: {},\n    sortedOrigin: {},\n\n    init() {\n        $(document).on('mousedown', '.sortable i[data-tool=\"sort\"]', e => {\n            this.startSort(e);\n        });\n        \n        $(document).on('mouseup', e => {\n            if (this.$sortedEl) this.stopSort(e);\n        });\n        \n        $(document).on('mousemove', e => {\n            if (this.$sortedEl) this.sort(e);\n        });\n    },\n    \n    startSort(e) {\n        const $icon = $(e.target);\n        this.$sortedEl = $icon.closest('.sortable');\n\n        this.$sortedEl.addClass('sorting');\n        \n        // Ignore sort if only child\n        if (this.$sortedEl.is(':only-child')) return;\n    \n        this.sortedPosition = this.$sortedEl.position();\n        \n        this.sortedOrigin = {\n            x: e.clientX,\n            y: e.clientY\n        };\n    \n        $icon.css('cursor', 'grabbing');\n    \n        this.$sortedEl.css('zIndex', '1');\n    \n        const $parent = this.$sortedEl.parent();\n    \n        this.$sortedEl.parent().css({\n            'width': $parent.outerWidth(),\n            'height': $parent.outerHeight()\n        });\n    \n        $parent.children().each((_, el) => {\n            const $el = $(el);\n            $el.css({\n                'top': $el.position().top,\n                'left': $el.position().left,\n                'width': $el.outerWidth(),\n                // 'height': $el.outerHeight()\n            });\n        });\n    \n        $parent.children().each((_, el) => {\n            $(el).css('position', 'absolute');\n        });\n    },\n    \n    sort(e) {\n        // const deltaX = e.clientX - this.sortedOrigin.x;\n        const deltaY = e.clientY - this.sortedOrigin.y;\n    \n        this.$sortedEl.css({\n            'top': Math.min(Math.max(this.sortedPosition.top + deltaY, this.$sortedEl.parent().position().top + parseInt(this.$sortedEl.parent().css('marginTop'), 10)), this.$sortedEl.parent().position().top + parseInt(this.$sortedEl.parent().css('marginTop'), 10) + this.$sortedEl.parent().outerHeight() - this.$sortedEl.outerHeight(true)),\n            // 'left': this.sortedPosition.left + deltaX\n        });\n    \n        this.$sortedEl.nextAll().each((_, el) => {\n            const $el = $(el);\n            if (this.$sortedEl.position().top + this.$sortedEl.outerHeight() > $el.position().top + $el.outerHeight() / 2) {\n                $el.css('top', $el.position().top - this.$sortedEl.outerHeight(true));\n                this.$sortedEl.before($el);\n            }\n        });\n    \n        this.$sortedEl.prevAll().each((_, el) => {\n            const $el = $(el);\n            if (this.$sortedEl.position().top < $el.position().top + $el.outerHeight() / 2) {\n                this.$sortedEl.after($el);\n                $el.css('top', $el.position().top + this.$sortedEl.outerHeight(true));\n            }\n        });\n    },\n    \n    stopSort(e) {\n        $(e.target).css('cursor', '');\n\n        this.$sortedEl.css({\n            'cursor': '',\n            'zIndex': ''\n        });\n        \n        const $parent = this.$sortedEl.parent();\n    \n        this.$sortedEl.parent().css({\n            'width': '',\n            'height': ''\n        });\n    \n        $parent.children().each((id, el) => {\n            const $el = $(el);\n            $el.css({\n                'top': '',\n                'left': '',\n                'width': '',\n                // 'height': '',\n                'position': ''\n            });\n\n            $el.attr('data-order', id);\n        });\n\n        if ($parent.parents('.calendars-wrap').length) _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].reorder();\n        else if ($parent.parents('.events-wrap').length) _events__WEBPACK_IMPORTED_MODULE_2__[\"default\"].reorder();\n\n        this.$sortedEl.removeClass('sorting');\n    \n        this.$sortedEl = null;\n\n        _stats__WEBPACK_IMPORTED_MODULE_3__[\"default\"].update();\n        _data__WEBPACK_IMPORTED_MODULE_1__[\"default\"].save();\n    }\n});\n\n//# sourceURL=webpack:///./src/js/sortable.js?");

/***/ }),

/***/ "./src/js/stats.js":
/*!*************************!*\
  !*** ./src/js/stats.js ***!
  \*************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n    init() {\n        this.update();\n\n        $(document).on('mouseenter', '.stat', e => {\n            const type = $(e.target).closest('.stat').attr('data-type');\n            $('.calendar-wrap .event').css('opacity', '.3');\n            $(`.calendar-wrap .event[data-type=\"${type}\"`).css('opacity', '');\n        });\n\n        $(document).on('mouseleave', '.stat', () => {\n            $('.calendar-wrap .event').css('opacity', '');\n        });\n    },\n\n    update() {\n        const events = $('.events-wrap ul li').toArray().map(el => {\n            const $el = $(el);\n            return {\n                title: $el.find('span.title').text(),\n                type: parseInt($el.attr('data-type')),\n                color: $el.attr('data-color')\n            }\n        });\n\n        \n        let html = '';\n        for (const event of events) {\n            const count = $(`.calendar-wrap .calendar.selected .event[data-type=\"${event.type}\"]`).length;\n\n            html += `<div class=\"stat\" data-type=\"${event.type}\">\n                <p>\n                    <span class=\"event-icon\" data-color=\"${event.color}\"></span>\n                    ${event.title}\n                    <span class=\"count\">${count}</span>\n                </p>\n            </div>`;\n        }\n        $('.stats').html(html);\n    }\n});\n\n//# sourceURL=webpack:///./src/js/stats.js?");

/***/ }),

/***/ "./src/js/templates.js":
/*!*****************************!*\
  !*** ./src/js/templates.js ***!
  \*****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _calendars__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./calendars */ \"./src/js/calendars.js\");\n/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./data */ \"./src/js/data.js\");\n/* harmony import */ var _dates__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./dates */ \"./src/js/dates.js\");\n/* harmony import */ var _events__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./events */ \"./src/js/events.js\");\n/* harmony import */ var _settings__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./settings */ \"./src/js/settings.js\");\n/* harmony import */ var _stats__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./stats */ \"./src/js/stats.js\");\n\n\n\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n    init() {\n        if (_data__WEBPACK_IMPORTED_MODULE_1__[\"default\"].loaded) return;\n\n        const template = _settings__WEBPACK_IMPORTED_MODULE_4__[\"default\"].template;\n\n        if (template === 'default') {\n            // 1 calendar\n            // 3 events\n            \n            this.createCalendars(1);\n            _events__WEBPACK_IMPORTED_MODULE_3__[\"default\"].newEvent([{ title: 'Workout', color: 5 }, { title: 'Tennis', color: 13 }, { title: 'Jogging', color: 9 }]);\n\n        } else if (template === 'filled') {\n            // 3 calendars\n            // 3 events\n            // 30 random occurences\n\n            this.createCalendars(3);\n            _events__WEBPACK_IMPORTED_MODULE_3__[\"default\"].newEvent([{ title: 'Workout', color: 5 }, { title: 'Tennis', color: 13 }, { title: 'Jogging', color: 9 }]);\n\n            for (let i = 0; i < 30; i += 1) {\n                const range = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].range(_calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].start, _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].end);\n                const date = range[Math.floor(Math.random() * range.length)];\n                \n                // Get a random event\n                const $events = $('.events-wrap ul li');\n                const $event = $events.eq(Math.floor(Math.random() * $events.length));\n\n                _events__WEBPACK_IMPORTED_MODULE_3__[\"default\"].buildEvent({\n                    id: ++_events__WEBPACK_IMPORTED_MODULE_3__[\"default\"].eventID,\n                    calendar: Math.floor(Math.random() * 3),\n                    type: Math.floor(Math.random() * 3),\n                    start: date,\n                    end: new Date(new Date(date).setDate(date.getDate() + Math.floor(Math.random() * 3)))\n                });\n            }\n\n            _stats__WEBPACK_IMPORTED_MODULE_5__[\"default\"].update();\n\n        } else if (template === 'events') {\n            // 1 calendar\n            // 20 events (for events colors testing)\n            // 20 occurences (one per event type)\n\n            this.createCalendars(1);\n            _events__WEBPACK_IMPORTED_MODULE_3__[\"default\"].newEvent([\n                { title: 'A', color: 0 },\n                { title: 'B', color: 1 },\n                { title: 'C', color: 2 },\n                { title: 'D', color: 3 },\n                { title: 'E', color: 4 },\n                { title: 'F', color: 5 },\n                { title: 'G', color: 6 },\n                { title: 'H', color: 7 },\n                { title: 'I', color: 8 },\n                { title: 'J', color: 9 },\n                { title: 'K', color: 10 },\n                { title: 'L', color: 11 },\n                { title: 'M', color: 12 },\n                { title: 'N', color: 13 },\n                { title: 'O', color: 14 },\n                { title: 'P', color: 15 },\n                { title: 'Q', color: 16 },\n                { title: 'R', color: 17 },\n                { title: 'S', color: 18 },\n                { title: 'T', color: 19 }\n            ]);\n\n            for (let i = 0; i < 20; i += 1) {\n                const date = _dates__WEBPACK_IMPORTED_MODULE_2__[\"default\"].relativeDate(_calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].start, i);\n\n                _events__WEBPACK_IMPORTED_MODULE_3__[\"default\"].buildEvent({\n                    id: ++_events__WEBPACK_IMPORTED_MODULE_3__[\"default\"].eventID,\n                    calendar: 0,\n                    type: i,\n                    start: date,\n                    end: date\n                });\n            }\n        }\n    },\n\n    createCalendars(n = 1) {\n        _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getStartEnd();\n        for (let i = 0; i < n; i += 1) _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].newCalendar();\n\n        _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].selectFirstCalendar();\n    }\n});\n\n//# sourceURL=webpack:///./src/js/templates.js?");

/***/ }),

/***/ "./src/js/tooltip.js":
/*!***************************!*\
  !*** ./src/js/tooltip.js ***!
  \***************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n    $tooltip: null,\n    showTimeout: null,\n\n    init() {\n        // Find tooltip element\n        this.$tooltip = $('.tooltip');\n\n        // Hover a tooltiped element\n        $(document).on('mouseenter', '[data-tooltip]', e => this.show(e));\n\n        // Leave a tooltiped element\n        $(document).on('mouseout', '[data-tooltip]', e => {\n            // Make sure we're not only hovering a child element to tooltiped element (or leaving it)\n            if ($(e.relatedTarget).is('[data-tooltip]') || $(e.relatedTarget).parents('[data-tooltip]').length) return;\n\n            this.hide();\n        });\n    },\n\n    show(e) {\n        const $el = $(e.currentTarget);\n        const text = $el.attr('data-tooltip');\n        const side = $el.attr('data-tooltip-side') || 'bottom';\n\n        this.$tooltip.find('.tooltip-content').html(text);\n\n        let top = 0;\n        let left = 0;\n        const margin = 8;\n        \n        if (side === 'top') {\n            top = $el.offset().top - this.$tooltip.outerHeight() - margin;\n            left = $el.offset().left + $el.outerWidth() / 2 - this.$tooltip.outerWidth() / 2;\n        } else if (side === 'right') {\n            top = $el.offset().top + $el.outerHeight() / 2 - this.$tooltip.outerHeight() / 2;\n            left =  $el.offset().left + $el.outerWidth() + margin;\n        } else if (side === 'bottom') {\n            top = $el.offset().top + $el.outerHeight() + margin;\n            left = $el.offset().left + $el.outerWidth() / 2 - this.$tooltip.outerWidth() / 2;\n        } else if (side === 'left') {\n            top = $el.offset().top + $el.outerHeight() / 2 - this.$tooltip.outerHeight() / 2;\n            left = $el.offset().left - this.$tooltip.outerWidth() - margin;\n        }\n\n        this.$tooltip\n            .css({\n                'top': top,\n                'left': left\n            })\n            .removeClass('top right bottom left')\n            .addClass(side);\n        \n        clearTimeout(this.showTimeout);\n        this.showTimeout = setTimeout(() => {\n            this.$tooltip.addClass('visible');\n        }, 1000);\n    },\n\n    hide() {\n        clearTimeout(this.showTimeout);\n        this.$tooltip.removeClass('visible');\n    }\n});\n\n//# sourceURL=webpack:///./src/js/tooltip.js?");

/***/ }),

/***/ "./src/js/ui.js":
/*!**********************!*\
  !*** ./src/js/ui.js ***!
  \**********************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _calendars__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./calendars */ \"./src/js/calendars.js\");\n/* harmony import */ var _data__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./data */ \"./src/js/data.js\");\n/* harmony import */ var _dates__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./dates */ \"./src/js/dates.js\");\n/* harmony import */ var _history__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./history */ \"./src/js/history.js\");\n/* harmony import */ var _selection__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./selection */ \"./src/js/selection.js\");\n\n\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n    view: 'full',\n    tool: 'select',\n    daysShown: [true, true, true, true, true, true, true],\n\n    init() {\n        $(document).on('click', 'header nav > ul > li', e => {\n            const $el = $(e.currentTarget);\n            $el.siblings('.open').removeClass('open');\n            $el.toggleClass('open');\n\n            return false;\n        });\n\n        $(document).on('mouseenter', 'header nav > ul > li', e => {\n            const $el = $(e.currentTarget);\n            if ($el.siblings('.open').length) {\n                $('header ul li.open').removeClass('open');\n                $el.toggleClass('open');\n            }\n\n            return false;\n        });\n\n        $(document).on('click', 'header nav li:not(.disabled)', e => {\n            const $target = $(e.currentTarget);\n\n            if ($target.attr('data-checkable') === '') {\n                if ($target.attr('data-radio')) this.onRadioChange($target);\n                else this.check($target);\n            } else if ($target.attr('data-tool')) {\n                const tool = $target.attr('data-tool');\n\n                if (tool === 'save') _data__WEBPACK_IMPORTED_MODULE_1__[\"default\"].download();\n                else if (tool === 'undo') _history__WEBPACK_IMPORTED_MODULE_3__[\"default\"].undo();\n                else if (tool === 'redo') _history__WEBPACK_IMPORTED_MODULE_3__[\"default\"].redo();\n                else if (tool === 'cut') _selection__WEBPACK_IMPORTED_MODULE_4__[\"default\"].cutSelection();\n                else if (tool === 'copy') _selection__WEBPACK_IMPORTED_MODULE_4__[\"default\"].copySelection();\n                else if (tool === 'paste') _selection__WEBPACK_IMPORTED_MODULE_4__[\"default\"].pasteSelection();\n                else if (tool === 'select-all') {\n                    _selection__WEBPACK_IMPORTED_MODULE_4__[\"default\"].selectAll();\n                    $('nav li.open').removeClass('open');\n                }\n                else if (tool === 'edit-all') {\n                    $target.toggleClass('checked');\n                    $('.calendars-wrap').toggleClass('edit-all');\n                }\n            }\n\n            return false;\n        });\n\n        $(document).on('click', '', e => {\n            $('header ul li.open').removeClass('open');\n        });\n\n        // Scroll in linear mode\n        $(document).on('mousewheel', '.calendar-wrap .calendars, .col-left', e => {\n            if (this.viewIs('full')) return;\n\n            // Keep scroll in sync\n            const scrollTop = e.currentTarget.scrollTop;\n            $('.calendar-wrap .calendars, .col-left').scrollTop(scrollTop);\n            \n            this.moveEventsTitles();\n        });\n\n        // Change tool\n        $(document).on('click', 'header .tool', e => {\n            this.changeTool($(e.currentTarget).attr('data-tool'));\n        });\n\n        // Click on day in timeline\n        $(document).on('click', '.head [data-day]', e => {\n            $('.head [data-day].open').removeClass('open');\n            $('.dropdown').removeClass('visible');\n\n            const $el = $(e.currentTarget);\n            $el.addClass('open');\n            $el.find('.dropdown').addClass('visible');\n            return false;\n        });\n\n        // Hide day column\n        $(document).on('click', '[data-tool=\"hide-weekday\"]', e => {\n            const $el = $(e.currentTarget);\n            const day = $el.closest('[data-day]').attr('data-day');\n            this.showHideWeekday(day, false);\n        });\n\n        $(document).on('click', '[data-view]', e => {\n            const $el = $(e.currentTarget);\n            const view = $el.attr('data-view');\n            if (view === 'full') this.fullView();\n            else if (view === 'linear') this.linearView();\n        });\n    },\n\n    check($target) {\n        const setting = $target.attr('data-setting');\n        const value = $target.attr('data-value');\n        const checked = $target.hasClass('checked');\n\n        if (setting === 'show-weekday') this.showHideWeekday(value, !checked);\n        else $target.toggleClass('checked');\n    },\n\n    onRadioChange($target) {\n        const radio = $target.attr('data-radio');\n        $(`nav [data-radio=\"${radio}\"]`).removeClass('checked');\n        $target.addClass('checked');\n\n        if (radio === 'view') {\n            const view = $target.attr('data-value');\n            if (view === 'full') this.fullView()\n            else if (view === 'linear') this.linearView();\n            _data__WEBPACK_IMPORTED_MODULE_1__[\"default\"].save();\n        }\n    },\n\n    fullView() {\n        this.view = 'full';\n\n        // Update UI\n        $('main').removeClass('linear');\n        $('[data-view]').removeClass('selected');\n        $('[data-view=\"full\"]').addClass('selected');\n\n        // Keep only one calendar\n        $('.calendar-wrap .calendar').eq(1).empty();\n        $('.calendar-wrap .calendar').slice(1).remove();\n\n        // Select current calendar\n        const $selectedCalendar = $('.calendars-wrap .calendar.selected');\n        _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].selectCalendar($selectedCalendar);\n\n        // Update height\n        _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].updateCalendarHeight();\n\n        // Check option in menu (when switched from shorcut)\n        $(`nav [data-radio=\"view\"]`).removeClass('checked');\n        $(`nav [data-radio=\"view\"][data-value=\"full\"]`).addClass('checked');\n    },\n\n    linearView() {\n        this.view = 'linear';\n\n        // Store .selected-first and .selected-last dates\n        const selectedFirst = $('.selected-first').attr('data-date');\n        const selectedLast = $('.selected-last').attr('data-date');\n\n        // Update UI\n        $('main').addClass('linear');\n        $('[data-view]').removeClass('selected');\n        $('[data-view=\"linear\"]').addClass('selected');\n\n        // Duplicate every minical\n        $('.calendar-wrap .calendar').remove();\n        $('.calendars-wrap .calendar').each((_, el) => {\n            const $el = $(el);\n            const content = $el.find('.content').html();\n            $('.calendar-wrap .calendars').append(`<div class=\"content calendar ${$el.hasClass('hidden') ? 'hidden' : ''}\" data-id=\"${$el.attr('data-id')}\">${content}</div>`);\n        });\n\n        // Select current calendar and restore .selected-first and .selected-last classes\n        const $selectedCalendar = $('.calendars-wrap .calendar.selected');\n        _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].selectCalendar($selectedCalendar, selectedFirst, selectedLast);\n\n        // Update height\n        _calendars__WEBPACK_IMPORTED_MODULE_0__[\"default\"].updateCalendarHeight();\n\n        // Check option in menu (when switched from shorcut)\n        $(`nav [data-radio=\"view\"]`).removeClass('checked');\n        $(`nav [data-radio=\"view\"][data-value=\"linear\"]`).addClass('checked');\n\n        this.moveEventsTitles();\n    },\n\n    viewIs(view) {\n        return this.view === view;\n    },\n\n    changeTool(tool) {\n        this.tool = tool;\n\n        // Update header UI\n        $('header .tool.selected').removeClass('selected');\n        $(`header .tool[data-tool=\"${tool}\"]`).addClass('selected');\n\n        // Update main calendar UI\n        $('.calendar-wrap').removeClass('select draw comment').addClass(tool);\n\n        // Remove selection when entering draw mode\n        if (tool === 'draw') {\n            _selection__WEBPACK_IMPORTED_MODULE_4__[\"default\"].selectedDays = [];\n            _selection__WEBPACK_IMPORTED_MODULE_4__[\"default\"].highlightSelection();\n        }\n\n        _data__WEBPACK_IMPORTED_MODULE_1__[\"default\"].save();\n    },\n\n    toolIs(tool) {\n        return this.tool === tool;\n    },\n\n    showHideWeekday(day, show) {\n        const $day = $(`[data-day=${day}]`);\n        const $li = $(`nav [data-setting=\"show-weekday\"][data-value=\"${day}\"]`);\n        if (show) {\n            $day.show();\n            $li.addClass('checked');\n        } else {\n            $day.hide();\n            $li.removeClass('checked');\n        }\n\n        this.daysShown[day] = show;\n        _data__WEBPACK_IMPORTED_MODULE_1__[\"default\"].save();\n    },\n\n    moveEventsTitles() {\n        // Keep (visible) event titles in view\n        $('.calendar-wrap .event .title:visible').each((_, el) => {\n            const $title = $(el);\n            const $event = $title.closest('.event');\n            const id = $event.attr('data-id');\n            const $events = $(`.calendar-wrap .event[data-id=\"${id}\"]`);\n\n            // Ignore one-day events\n            if ($events.length === 1) return;\n\n            // Total event width (add up single .events widths)\n            const width = $events.toArray().reduce((acc, curr) => acc + curr.offsetWidth, 0);\n            \n            const eventOffsetLeft = $event.offset().left;\n            const eventOffsetRight = eventOffsetLeft + width;\n            const colWidth = $(window).width() <= 1120 ? 24 : 240;\n            \n            if (eventOffsetLeft < colWidth && eventOffsetRight > colWidth) {\n                const top = $event.offset().top + 2;\n\n                // Make title stick to left border or right end of event\n                const left = Math.min(Math.ceil(eventOffsetRight - $title.outerWidth() - (colWidth + 14)), 0) + colWidth + 6;\n\n                $title.css({\n                    'position': 'fixed',\n                    'top': top,\n                    'left': left\n                });\n            } else {\n                $title.css({\n                    'position': '',\n                    'top': '',\n                    'left': ''\n                });\n            }\n        });\n    }\n});\n\n//# sourceURL=webpack:///./src/js/ui.js?");

/***/ })

/******/ });